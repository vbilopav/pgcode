/*build: 2020-11-03 14:06:57:784, hash: c14c, copyright VB-Consulting*/
(function(){"use strict";const e=this;"object"==typeof global&&global;var t;!function(t){t.global=e;class i{constructor(){this._detected=!1,this._isWindows=!1,this._isWebWorker=!1}get isWindows(){return this._detect(),this._isWindows}get isWebWorker(){return this._detect(),this._isWebWorker}_detect(){this._detected||(this._detected=!0,this._isWindows=i._isWindows(),this._isWebWorker="function"==typeof t.global.importScripts)}static _isWindows(){return!!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Windows")>=0)}}t.Environment=i}(t||(t={})),function(e){class t{constructor(e,t,i){this.type=e,this.detail=t,this.timestamp=i}}e.LoaderEvent=t;e.LoaderEventRecorder=class{constructor(e){this._events=[new t(1,"",e)]}record(i,r){this._events.push(new t(i,r,e.Utilities.getHighPerformanceTimestamp()))}getEvents(){return this._events}};class i{record(e,t){}getEvents(){return[]}}i.INSTANCE=new i,e.NullLoaderEventRecorder=i}(t||(t={})),function(e){class t{static fileUriToFilePath(e,t){if(t=decodeURI(t).replace(/%23/g,"#"),e){if(/^file:\/\/\//.test(t))return t.substr(8);if(/^file:\/\//.test(t))return t.substr(5)}else if(/^file:\/\//.test(t))return t.substr(7);return t}static startsWith(e,t){return e.length>=t.length&&e.substr(0,t.length)===t}static endsWith(e,t){return e.length>=t.length&&e.substr(e.length-t.length)===t}static containsQueryString(e){return/^[^\#]*\?/gi.test(e)}static isAbsolutePath(e){return/^((http:\/\/)|(https:\/\/)|(file:\/\/)|(\/))/.test(e)}static forEachProperty(e,t){if(e){let i;for(i in e)e.hasOwnProperty(i)&&t(i,e[i])}}static isEmpty(e){let i=!0;return t.forEachProperty(e,()=>{i=!1}),i}static recursiveClone(e){if(!e||"object"!=typeof e)return e;let i=Array.isArray(e)?[]:{};return t.forEachProperty(e,(e,r)=>{i[e]=r&&"object"==typeof r?t.recursiveClone(r):r}),i}static generateAnonymousModule(){return"===anonymous"+t.NEXT_ANONYMOUS_ID+++"==="}static isAnonymousModule(e){return t.startsWith(e,"===anonymous")}static getHighPerformanceTimestamp(){return this.PERFORMANCE_NOW_PROBED||(this.PERFORMANCE_NOW_PROBED=!0,this.HAS_PERFORMANCE_NOW=e.global.performance&&"function"==typeof e.global.performance.now),this.HAS_PERFORMANCE_NOW?e.global.performance.now():Date.now()}}t.NEXT_ANONYMOUS_ID=1,t.PERFORMANCE_NOW_PROBED=!1,t.HAS_PERFORMANCE_NOW=!1,e.Utilities=t}(t||(t={})),function(e){class t{static validateConfigurationOptions(t){return"string"!=typeof(t=t||{}).baseUrl&&(t.baseUrl=""),"boolean"!=typeof t.isBuild&&(t.isBuild=!1),"object"!=typeof t.paths&&(t.paths={}),"object"!=typeof t.config&&(t.config={}),void 0===t.catchError&&(t.catchError=!1),"string"!=typeof t.urlArgs&&(t.urlArgs=""),"function"!=typeof t.onError&&(t.onError=function(e){return"load"===e.errorCode?(console.error('Loading "'+e.moduleId+'" failed'),console.error("Detail: ",e.detail),e.detail&&e.detail.stack&&console.error(e.detail.stack),console.error("Here are the modules that depend on it:"),void console.error(e.neededBy)):"factory"===e.errorCode?(console.error('The factory method of "'+e.moduleId+'" has thrown an exception'),console.error(e.detail),void(e.detail&&e.detail.stack&&console.error(e.detail.stack))):void 0}),"object"==typeof t.ignoreDuplicateModules&&Array.isArray(t.ignoreDuplicateModules)||(t.ignoreDuplicateModules=[]),t.baseUrl.length>0&&(e.Utilities.endsWith(t.baseUrl,"/")||(t.baseUrl+="/")),"string"!=typeof t.cspNonce&&(t.cspNonce=""),Array.isArray(t.nodeModules)||(t.nodeModules=[]),t}static mergeConfigurationOptions(i=null,r=null){let o=e.Utilities.recursiveClone(r||{});return e.Utilities.forEachProperty(i,(t,i)=>{"ignoreDuplicateModules"===t&&void 0!==o.ignoreDuplicateModules?o.ignoreDuplicateModules=o.ignoreDuplicateModules.concat(i):"paths"===t&&void 0!==o.paths?e.Utilities.forEachProperty(i,(e,t)=>o.paths[e]=t):"config"===t&&void 0!==o.config?e.Utilities.forEachProperty(i,(e,t)=>o.config[e]=t):o[t]=e.Utilities.recursiveClone(i)}),t.validateConfigurationOptions(o)}}e.ConfigurationOptionsUtil=t;class i{constructor(e,i){this._env=e,this.options=t.mergeConfigurationOptions(i),this._createIgnoreDuplicateModulesMap(),this._createSortedPathsRules()}_createIgnoreDuplicateModulesMap(){this.ignoreDuplicateModulesMap={};for(let e=0;e<this.options.ignoreDuplicateModules.length;e++)this.ignoreDuplicateModulesMap[this.options.ignoreDuplicateModules[e]]=!0}_createSortedPathsRules(){this.sortedPathsRules=[],e.Utilities.forEachProperty(this.options.paths,(e,t)=>{Array.isArray(t)?this.sortedPathsRules.push({from:e,to:t}):this.sortedPathsRules.push({from:e,to:[t]})}),this.sortedPathsRules.sort((e,t)=>t.from.length-e.from.length)}cloneAndMerge(e){return new i(this._env,t.mergeConfigurationOptions(e,this.options))}getOptionsLiteral(){return this.options}ihjslyPaths(t){if(t.endsWith(".html"))return[t];if(t.endsWith("__temp"))return[t.substring(0,t.length-6)];let i;for(let r=0,o=this.sortedPathsRules.length;r<o;r++)if(i=this.sortedPathsRules[r],e.Utilities.startsWith(t,i.from)){let e=[];for(let r=0,o=i.to.length;r<o;r++)e.push(i.to[r]+t.substr(i.from.length));return e}return[t]}_addUrlArgsToUrl(t){return e.Utilities.containsQueryString(t)?t+"&"+this.options.urlArgs:t+"?"+this.options.urlArgs}_addUrlArgsIfNecessaryToUrl(e){return this.options.urlArgs?this._addUrlArgsToUrl(e):e}_addUrlArgsIfNecessaryToUrls(e){if(this.options.urlArgs)for(let t=0,i=e.length;t<i;t++)e[t]=this._addUrlArgsToUrl(e[t]);return e}moduleIdToPaths(t){let i,r=t;if(e.Utilities.endsWith(r,".js")||e.Utilities.isAbsolutePath(r))e.Utilities.endsWith(r,".js")||e.Utilities.containsQueryString(r)||(r+=".js"),i=[r];else for(let t=0,o=(i=this.ihjslyPaths(r)).length;t<o;t++)this.isBuild()&&"empty:"===i[t]||(e.Utilities.isAbsolutePath(i[t])||(i[t]=this.options.baseUrl+i[t]),e.Utilities.endsWith(i[t],".js")||e.Utilities.containsQueryString(i[t])||(i[t]=i[t]+".js"));return this._addUrlArgsIfNecessaryToUrls(i)}requireToUrl(t){let i=t;return e.Utilities.isAbsolutePath(i)||(i=this.ihjslyPaths(i)[0],e.Utilities.isAbsolutePath(i)||(i=this.options.baseUrl+i)),this._addUrlArgsIfNecessaryToUrl(i)}isBuild(){return this.options.isBuild}isDuplicateMessageIgnoredFor(e){return this.ignoreDuplicateModulesMap.hasOwnProperty(e)}getConfigForModule(e){if(this.options.config)return this.options.config[e]}shouldCatchError(){return this.options.catchError}shouldRecordStats(){return this.options.recordStats}onError(e){this.options.onError(e)}}e.Configuration=i}(t||(t={})),function(e){class t{constructor(e){this._env=e,this._scriptLoader=null,this._callbackMap={}}load(e,t,o,n){this._scriptLoader||(this._scriptLoader=this._env.isWebWorker?new r:new i);let s={callback:o,errorback:n};this._callbackMap.hasOwnProperty(t)?this._callbackMap[t].push(s):(this._callbackMap[t]=[s],this._scriptLoader.load(e,t,()=>this.triggerCallback(t),e=>this.triggerErrorback(t,e)))}triggerCallback(e){let t=this._callbackMap[e];delete this._callbackMap[e];for(let e=0;e<t.length;e++)t[e].callback()}triggerErrorback(e,t){let i=this._callbackMap[e];delete this._callbackMap[e];for(let e=0;e<i.length;e++)i[e].errorback(t)}}class i{attachListeners(e,t,i){let r=()=>{e.removeEventListener("load",o),e.removeEventListener("error",n)},o=e=>{r(),t()},n=e=>{r(),i(e)};e.addEventListener("load",o),e.addEventListener("error",n)}load(e,t,i,r){let o=document.createElement("script");o.setAttribute("async","async"),o.setAttribute("type","text/javascript"),this.attachListeners(o,i,r),o.setAttribute("src",t);const{cspNonce:n}=e.getConfig().getOptionsLiteral();n&&o.setAttribute("nonce",n),document.getElementsByTagName("head")[0].appendChild(o)}}class r{load(e,t,i,r){try{importScripts(t),i()}catch(e){r(e)}}}e.createScriptLoader=function(e){return new t(e)}}(t||(t={})),function(e){class t{constructor(e){let t=e.lastIndexOf("/");this.fromModulePath=-1!==t?e.substr(0,t+1):""}static _normalizeModuleId(e){let t,i=e;for(t=/\/\.\//;t.test(i);)i=i.replace(t,"/");for(i=i.replace(/^\.\//g,""),t=/\/(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//;t.test(i);)i=i.replace(t,"/");return i=i.replace(/^(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//,"")}resolveModule(i){let r=i;return e.Utilities.isAbsolutePath(r)||(e.Utilities.startsWith(r,"./")||e.Utilities.startsWith(r,"../"))&&(r=t._normalizeModuleId(this.fromModulePath+r)),r}}t.ROOT=new t(""),e.ModuleIdResolver=t;class i{constructor(e,t,i,r,o,n){this.id=e,this.strId=t,this.dependencies=i,this._callback=r,this._errorback=o,this.moduleIdResolver=n,this.exports={},this.exportsPassedIn=!1,this.unresolvedDependenciesCount=this.dependencies.length,this._isComplete=!1}static _safeInvokeFunction(t,i){try{return{returnedValue:t.apply(e.global,i),producedError:null}}catch(e){return{returnedValue:null,producedError:e}}}static _invokeFactory(t,i,r,o){return t.isBuild()&&!e.Utilities.isAnonymousModule(i)?{returnedValue:null,producedError:null}:t.shouldCatchError()?this._safeInvokeFunction(r,o):{returnedValue:r.apply(e.global,o),producedError:null}}complete(t,r,o){this._isComplete=!0;let n=null;if(this._callback)if("function"==typeof this._callback){t.record(21,this.strId);let s=i._invokeFactory(r,this.strId,this._callback,o);n=s.producedError,t.record(22,this.strId),n||void 0===s.returnedValue||this.exportsPassedIn&&!e.Utilities.isEmpty(this.exports)||(this.exports=s.returnedValue)}else this.exports=this._callback;n&&r.onError({errorCode:"factory",moduleId:this.strId,detail:n}),this.dependencies=null,this._callback=null,this._errorback=null,this.moduleIdResolver=null}onDependencyError(e){return!!this._errorback&&(this._errorback(e),!0)}isComplete(){return this._isComplete}}e.Module=i;class r{constructor(){this._nextId=0,this._strModuleIdToIntModuleId=new Map,this._intModuleIdToStrModuleId=[],this.getModuleId("exports"),this.getModuleId("module"),this.getModuleId("require")}getMaxModuleId(){return this._nextId}getModuleId(e){let t=this._strModuleIdToIntModuleId.get(e);return void 0===t&&(t=this._nextId++,this._strModuleIdToIntModuleId.set(e,t),this._intModuleIdToStrModuleId[t]=e),t}getStrModuleId(e){return this._intModuleIdToStrModuleId[e]}}class o{constructor(e){this.id=e}}o.EXPORTS=new o(0),o.MODULE=new o(1),o.REQUIRE=new o(2),e.RegularDependency=o;class n{constructor(e,t,i){this.id=e,this.pluginId=t,this.pluginParam=i}}e.PluginDependency=n;class s{constructor(t,i,o,n,s=0){this._env=t,this._scriptLoader=i,this._loaderAvailableTimestamp=s,this._defineFunc=o,this._requireFunc=n,this._moduleIdProvider=new r,this._config=new e.Configuration(this._env),this._modules2=[],this._knownModules2=[],this._inverseDependencies2=[],this._inversePluginDependencies2=new Map,this._currentAnnonymousDefineCall=null,this._recorder=null,this._buildInfoPath=[],this._buildInfoDefineStack=[],this._buildInfoDependencies=[]}reset(){return new s(this._env,this._scriptLoader,this._defineFunc,this._requireFunc,this._loaderAvailableTimestamp)}getGlobalAMDDefineFunc(){return this._defineFunc}getGlobalAMDRequireFunc(){return this._requireFunc}static _findRelevantLocationInStack(e,t){let i=e=>e.replace(/\\/g,"/"),r=i(e),o=t.split(/\n/);for(let e=0;e<o.length;e++){let t=o[e].match(/(.*):(\d+):(\d+)\)?$/);if(t){let e=t[1],o=t[2],n=t[3],s=Math.max(e.lastIndexOf(" ")+1,e.lastIndexOf("(")+1);if((e=i(e=e.substr(s)))===r){let e={line:parseInt(o,10),col:parseInt(n,10)};return 1===e.line&&(e.col-="(function (require, define, __filename, __dirname) { ".length),e}}}throw new Error("Could not correlate define call site for needle "+e)}getBuildInfo(){if(!this._config.isBuild())return null;let e=[],t=0;for(let i=0,r=this._modules2.length;i<r;i++){let r=this._modules2[i];if(!r)continue;let o=this._buildInfoPath[r.id]||null,n=this._buildInfoDefineStack[r.id]||null,l=this._buildInfoDependencies[r.id];e[t++]={id:r.strId,path:o,defineLocation:o&&n?s._findRelevantLocationInStack(o,n):null,dependencies:l,shim:null,exports:r.exports}}return e}getRecorder(){return this._recorder||(this._config.shouldRecordStats()?this._recorder=new e.LoaderEventRecorder(this._loaderAvailableTimestamp):this._recorder=e.NullLoaderEventRecorder.INSTANCE),this._recorder}getLoaderEvents(){return this.getRecorder().getEvents()}enqueueDefineAnonymousModule(e,t){if(null!==this._currentAnnonymousDefineCall)throw new Error("Can only have one anonymous define call per script file");let i=null;this._config.isBuild()&&(i=new Error("StackLocation").stack),this._currentAnnonymousDefineCall={stack:i,dependencies:e,callback:t}}defineModule(e,r,o,n,s,l=new t(e)){let d=this._moduleIdProvider.getModuleId(e);if(this._modules2[d])return void(this._config.isDuplicateMessageIgnoredFor(e)||console.warn("Duplicate definition of module '"+e+"'"));let u=new i(d,e,this._normalizeDependencies(r,l),o,n,l);this._modules2[d]=u,this._config.isBuild()&&(this._buildInfoDefineStack[d]=s,this._buildInfoDependencies[d]=u.dependencies.map(e=>this._moduleIdProvider.getStrModuleId(e.id))),this._resolve(u)}_normalizeDependency(e,t){if("exports"===e)return o.EXPORTS;if("module"===e)return o.MODULE;if("require"===e)return o.REQUIRE;let i=e.indexOf("!");if(i>=0){let r=t.resolveModule(e.substr(0,i)),o=t.resolveModule(e.substr(i+1)),s=this._moduleIdProvider.getModuleId(r+"!"+o),l=this._moduleIdProvider.getModuleId(r);return new n(s,l,o)}return new o(this._moduleIdProvider.getModuleId(t.resolveModule(e)))}_normalizeDependencies(e,t){let i=[],r=0;for(let o=0,n=e.length;o<n;o++)i[r++]=this._normalizeDependency(e[o],t);return i}_relativeRequire(t,i,r,o){if("string"==typeof i)return this.synchronousRequire(i,t);this.defineModule(e.Utilities.generateAnonymousModule(),i,r,o,null,t)}synchronousRequire(e,i=new t(e)){let r=this._normalizeDependency(e,i),o=this._modules2[r.id];if(!o)throw new Error("Check dependency list! Synchronous require cannot resolve module '"+e+"'. This is the first mention of this module!");if(!o.isComplete())throw new Error("Check dependency list! Synchronous require cannot resolve module '"+e+"'. This module has not been resolved completely yet.");return o.exports}configure(t,i){let r=this._config.shouldRecordStats();this._config=i?new e.Configuration(this._env,t):this._config.cloneAndMerge(t),this._config.shouldRecordStats()&&!r&&(this._recorder=null)}getConfig(){return this._config}_onLoad(e){if(null!==this._currentAnnonymousDefineCall){let t=this._currentAnnonymousDefineCall;this._currentAnnonymousDefineCall=null,this.defineModule(this._moduleIdProvider.getStrModuleId(e),t.dependencies,t.callback,null,t.stack)}}_createLoadError(e,t){return{errorCode:"load",moduleId:this._moduleIdProvider.getStrModuleId(e),neededBy:(this._inverseDependencies2[e]||[]).map(e=>this._moduleIdProvider.getStrModuleId(e)),detail:t}}_onLoadError(e,t){let i=this._createLoadError(e,t),r=[];for(let e=0,t=this._moduleIdProvider.getMaxModuleId();e<t;e++)r[e]=!1;let o=!1,n=[];for(n.push(e),r[e]=!0;n.length>0;){let e=n.shift(),t=this._modules2[e];t&&(o=t.onDependencyError(i)||o);let s=this._inverseDependencies2[e];if(s)for(let e=0,t=s.length;e<t;e++){let t=s[e];r[t]||(n.push(t),r[t]=!0)}}o||this._config.onError(i)}_hasDependencyPath(e,t){let i=this._modules2[e];if(!i)return!1;let r=[];for(let e=0,t=this._moduleIdProvider.getMaxModuleId();e<t;e++)r[e]=!1;let o=[];for(o.push(i),r[e]=!0;o.length>0;){let e=o.shift().dependencies;if(e)for(let i=0,n=e.length;i<n;i++){let n=e[i];if(n.id===t)return!0;let s=this._modules2[n.id];s&&!r[n.id]&&(r[n.id]=!0,o.push(s))}}return!1}_findCyclePath(e,t,i){if(e===t||50===i)return[e];let r=this._modules2[e];if(!r)return null;let o=r.dependencies;for(let r=0,n=o.length;r<n;r++){let n=this._findCyclePath(o[r].id,t,i+1);if(null!==n)return n.push(e),n}return null}_createRequire(e){let t=(t,i,r)=>this._relativeRequire(e,t,i,r);return t.toUrl=(t=>this._config.requireToUrl(e.resolveModule(t))),t.getStats=(()=>this.getLoaderEvents()),t}_loadModule(e){if(this._modules2[e]||this._knownModules2[e])return;this._knownModules2[e]=!0;let t=this._moduleIdProvider.getStrModuleId(e);if(this._config.options._modules){let e=t.replace("__temp",""),i=this._config.options._modules[e]||this._config.options._modules[this._config.options.baseUrl+e];if(i)return void this.defineModule(t,i[0],i[1],null,null)}let i=this._config.moduleIdToPaths(t),r=-1,o=t=>{if(++r>=i.length)this._onLoadError(e,t);else{let t=i[r],n=this.getRecorder();if(this._config.isBuild()&&"empty:"===t)return this._buildInfoPath[e]=t,this.defineModule(this._moduleIdProvider.getStrModuleId(e),[],null,null,null),void this._onLoad(e);n.record(10,t),this._scriptLoader.load(this,t,()=>{this._config.isBuild()&&(this._buildInfoPath[e]=t),n.record(11,t),this._onLoad(e)},e=>{n.record(12,t),o(e)})}};o(null)}_loadPluginDependency(e,i){if(this._modules2[i.id]||this._knownModules2[i.id])return;this._knownModules2[i.id]=!0;let r=e=>{this.defineModule(this._moduleIdProvider.getStrModuleId(i.id),[],e,null,null)};r.error=(e=>{this._config.onError(this._createLoadError(i.id,e))}),e.load(i.pluginParam,this._createRequire(t.ROOT),r,this._config.getOptionsLiteral())}_resolve(e){let t=e.dependencies;for(let i=0,r=t.length;i<r;i++){let r=t[i];if(r===o.EXPORTS){e.exportsPassedIn=!0,e.unresolvedDependenciesCount--;continue}if(r===o.MODULE){e.unresolvedDependenciesCount--;continue}if(r===o.REQUIRE){e.unresolvedDependenciesCount--;continue}let s=this._modules2[r.id];if(s&&s.isComplete())e.unresolvedDependenciesCount--;else if(this._hasDependencyPath(r.id,e.id)){console.warn("There is a dependency cycle between '"+this._moduleIdProvider.getStrModuleId(r.id)+"' and '"+this._moduleIdProvider.getStrModuleId(e.id)+"'. The cyclic path follows:");let t=this._findCyclePath(r.id,e.id,0);t.reverse(),t.push(r.id),console.warn(t.map(e=>this._moduleIdProvider.getStrModuleId(e)).join(" => \n")),e.unresolvedDependenciesCount--}else if(this._inverseDependencies2[r.id]=this._inverseDependencies2[r.id]||[],this._inverseDependencies2[r.id].push(e.id),r instanceof n){let e=this._modules2[r.pluginId];if(e&&e.isComplete()){this._loadPluginDependency(e.exports,r);continue}let t=this._inversePluginDependencies2.get(r.pluginId);t||(t=[],this._inversePluginDependencies2.set(r.pluginId,t)),t.push(r),this._loadModule(r.pluginId)}else this._loadModule(r.id)}0===e.unresolvedDependenciesCount&&this._onModuleComplete(e)}_onModuleComplete(e){let t=this.getRecorder();if(e.isComplete())return;let i=e.dependencies,r=[];for(let t=0,n=i.length;t<n;t++){let n=i[t];if(n===o.EXPORTS){r[t]=e.exports;continue}if(n===o.MODULE){r[t]={id:e.strId,config:()=>this._config.getConfigForModule(e.strId)};continue}if(n===o.REQUIRE){r[t]=this._createRequire(e.moduleIdResolver);continue}let s=this._modules2[n.id];s?r[t]=s.exports:r[t]=null}e.complete(t,this._config,r);let n=this._inverseDependencies2[e.id];if(this._inverseDependencies2[e.id]=null,n)for(let e=0,t=n.length;e<t;e++){let t=n[e],i=this._modules2[t];i.unresolvedDependenciesCount--,0===i.unresolvedDependenciesCount&&this._onModuleComplete(i)}let s=this._inversePluginDependencies2.get(e.id);if(s){this._inversePluginDependencies2.delete(e.id);for(let t=0,i=s.length;t<i;t++)this._loadPluginDependency(e.exports,s[t])}}}e.ModuleManager=s}(t||(t={})),function(e){const t=new e.Environment;let i=null;const r=function(e,t,r){"string"!=typeof e&&(r=t,t=e,e=null),"object"==typeof t&&Array.isArray(t)||(r=t,t=null),t||(t=["require","exports","module"]),e?i.defineModule(e,t,r,null,null):i.enqueueDefineAnonymousModule(t,r)};r.amd={jQuery:!0};const o=function(e,t=!1){i.configure(e,t)},n=function(){if(1===arguments.length){if(arguments[0]instanceof Object&&!Array.isArray(arguments[0]))return void o(arguments[0]);if("string"==typeof arguments[0])return i.synchronousRequire(arguments[0])}if(2!==arguments.length&&3!==arguments.length||!Array.isArray(arguments[0]))throw new Error("Unrecognized require call");i.defineModule(e.Utilities.generateAnonymousModule(),arguments[0],arguments[1],arguments[2],null)};function s(){if(void 0!==e.global.require||"undefined"!=typeof require){const t=e.global.require||require;if("function"==typeof t&&"function"==typeof t.resolve){const r=function(e){i.getRecorder().record(33,e);try{return t(e)}finally{i.getRecorder().record(34,e)}};e.global.nodeRequire=r,n.nodeRequire=r,n.__$__nodeRequire=r}}e.global.require=n,e.global.define=r}n.config=o,n.getConfig=function(){return i.getConfig().getOptionsLiteral()},n.reset=function(){i=i.reset()},n.getBuildInfo=function(){return i.getBuildInfo()},n.getStats=function(){return i.getLoaderEvents()},n.define=function(){return r.apply(null,arguments)},e.init=s,"function"==typeof e.global.define&&e.global.define.amd||(i=new e.ModuleManager(t,e.createScriptLoader(t),r,n,e.Utilities.getHighPerformanceTimestamp()),void 0!==e.global.require&&"function"!=typeof e.global.require&&n.config(e.global.require),function(){return r.apply(null,arguments)}.amd=r.amd,"undefined"==typeof doNotInitLoader&&s())}(t||(t={}))}).call(window); require.config({_modules:{'js/extensions/apply': [["js/extensions/test-proto"],e=>{let t,n=(t,n,o=!1)=>{t="string"==typeof t?window[t]:t,e(t,[n]),t.prototype[n]="NodeList"===t||"HTMLCollection"===t||o?function(...e){for(let t of this)t[n](...e);return this}:HTMLElement.prototype[n]},o=(e,t,o=!1)=>{for(let s of t)n(e,s,o)};return{loadExtensions(e){let n=[];for(let[t,o]of Object.entries(e))n.push(...o.map(e=>"js/extensions/"+t+"/"+e));return new Promise(o=>require(n,()=>{t=Object.assign(t||{},e),o()}))},applyExtensions:o,applyAllExtensions:(e,n,s=!1)=>{o(e,t[n],s)},applyExtensionsExcept:(e,n,s,i=!1)=>{o(e,t[n].filter(e=>!s.includes(e)),i)}}}],'js/extensions/html': [[],()=>{const e=e=>{let t=document.createElement("template");return t.innerHTML=e.trim(),t},t=(e,t,n)=>{let r="object"==typeof e?document.createElement(e.toString()):document.createElement(e);return t&&(r.id=t),n&&r.html(n),r};return{tagToElement:t,strToElement:t=>e(t).content.firstChild,strToElements:t=>e(t).content.childNodes,stripHtml:e=>{var n=t("div");return n.innerHTML=e,n.textContent||n.innerText||""}}}],'js/extensions/HTMLElement/addClass': [["js/extensions/test-proto"],s=>{s(HTMLElement,["addClass"]),HTMLElement.prototype.addClass=function(s){return this.classList?this.classList.add(s):this.className+=` ${s}`,this}}],'js/extensions/HTMLElement/appendElement': [["js/extensions/test-proto"],e=>{e(HTMLElement,["appendElement"]),HTMLElement.prototype.appendElement=function(e){return this.appendChild(e),this}}],'js/extensions/HTMLElement/appendElementTo': [["js/extensions/test-proto"],e=>{e(HTMLElement,["appendElementTo"]),HTMLElement.prototype.appendElementTo=function(e){return e.append(this),this}}],'js/extensions/HTMLElement/attr': [["js/extensions/test-proto"],t=>{t(HTMLElement,["attr"]),HTMLElement.prototype.attr=function(t,e,i){return void 0===e?this.getAttribute(t):(!1===i?this.removeAttribute(t):this.setAttribute(t,e),this)}}],'js/extensions/HTMLElement/clone': [["js/extensions/test-proto","js/extensions/HTMLElement/css"],e=>{e(HTMLElement,["clone"]),HTMLElement.prototype.clone=function(e){const t=this.cloneNode(e);return t._styles=this._styles,t._data=this._data,t}}],'js/extensions/HTMLElement/css': [["js/extensions/test-proto","js/extensions/String/toCamelCase"],s=>{s(HTMLElement,["css","_styles"]),HTMLElement.prototype.css=function(s,t){if(!this._styles){this._styles={};const s=window.getComputedStyle(this);for(let t in s)isNaN(t)&&(this._styles[t]=s[t])}if(void 0!==t)return this._styles[s]=t,this.style[s]=t,this;const e=this._styles[s];return void 0===e?this._styles[s.toCamelCase()]:e}}],'js/extensions/HTMLElement/dataAttr': [["js/extensions/test-proto"],t=>{t(HTMLElement,["dataAttr","_data"]),HTMLElement.prototype.dataAttr=function(t,a){return this._data||(this._data=Object.assign({},this.dataset)),void 0!==a?(this._data[t]=a,this):this._data[t]}}],'js/extensions/HTMLElement/find': [["js/extensions/test-proto","js/extensions/String/createElement"],e=>{e(HTMLElement,["find"]),HTMLElement.prototype.find=function(e){let t=this.querySelector(e);return t?(t.length=1,t):((t="dummy".createElement()).length=0,t)}}],'js/extensions/HTMLElement/findAll': [["js/extensions/test-proto"],e=>{e(HTMLElement,["findAll"]),HTMLElement.prototype.findAll=function(e){return this.querySelectorAll(e)}}],'js/extensions/HTMLElement/forEachChild': [["js/extensions/test-proto"],t=>{t(HTMLElement,["forEachChild"]),HTMLElement.prototype.forEachChild=function(t=(()=>{}),e=!1){e&&t(this);for(let e=0,h=this.children.length;e<h;e++){let h=this.children[e];if(!h)return this;h.children.length?h.forEachChild(t,!0):t(h)}return this}}],'js/extensions/HTMLElement/hasClass': [["js/extensions/test-proto"],s=>{s(HTMLElement,["hasClass"]),HTMLElement.prototype.hasClass=function(s){return this.classList?this.classList.contains(s):new RegExp(`(^| )${s}( |$)`,"gi").test(this.className)}}],'js/extensions/HTMLElement/hideElement': [["js/extensions/test-proto","js/extensions/HTMLElement/css"],e=>{e(HTMLElement,["hideElement"]),HTMLElement.prototype.hideElement=function(){return this.css("display","none"),this}}],'js/extensions/HTMLElement/html': [["js/extensions/test-proto"],t=>{t(HTMLElement,["html"]),HTMLElement.prototype.html=function(t){return void 0===t?this.innerHTML:(this.innerHTML=t,this)}}],'js/extensions/HTMLElement/nextElementSiblingWithClass': [["js/extensions/test-proto"],e=>{e(HTMLElement,["nextElementSiblingWithClass"]),HTMLElement.prototype.nextElementSiblingWithClass=function(e){const t=this.nextElementSibling;return t.hasClass(e)?t:t.nextElementSiblingWithClass(e)}}],'js/extensions/HTMLElement/off': [["js/extensions/test-proto"],e=>{e(HTMLElement,["off"]),HTMLElement.prototype.off=function(e,t){for(let o of e.split(" "))this.removeEventListener(o,t);return this}}],'js/extensions/HTMLElement/on': [["js/extensions/test-proto"],t=>{t(HTMLElement,["on"]),HTMLElement.prototype.on=function(t,e){for(let n of t.split(" "))this.addEventListener(n,e);return this}}],'js/extensions/HTMLElement/overflownX': [["js/extensions/test-proto"],t=>{t(HTMLElement,["overflownX"]),HTMLElement.prototype.overflownX=function(){return this.scrollWidth>this.clientWidth}}],'js/extensions/HTMLElement/overflownY': [["js/extensions/test-proto"],e=>{e(HTMLElement,["overflownY"]),HTMLElement.prototype.overflownY=function(){return this.scrollHeight>this.clientHeight}}],'js/extensions/HTMLElement/removeAttr': [["js/extensions/test-proto"],t=>{t(HTMLElement,["removeAttr"]),HTMLElement.prototype.removeAttr=function(t){return this.removeAttribute(t),this}}],'js/extensions/HTMLElement/removeClass': [["js/extensions/test-proto"],s=>{s(HTMLElement,["removeClass"]),HTMLElement.prototype.removeClass=function(s){return this.classList?this.classList.remove(s):this.className=this.className.replace(new RegExp(`(^|\\b)${s.split(" ").join("|")}(\\b|$)`,"gi")," "),this}}],'js/extensions/HTMLElement/setFocus': [["js/extensions/test-proto"],t=>{t(HTMLElement,["setFocus"]),HTMLElement.prototype.setFocus=function(){return this.focus(),this}}],'js/extensions/HTMLElement/showElement': [["js/extensions/test-proto","js/extensions/HTMLElement/css"],e=>{e(HTMLElement,["showElement"]),HTMLElement.prototype.showElement=function(e){return void 0===e||e?(this.css("display",""),this):this.hideElement()}}],'js/extensions/HTMLElement/switchPlaces': [["js/extensions/test-proto","js/extensions/HTMLElement/css"],e=>{e(HTMLElement,["switchPlaces"]),HTMLElement.prototype.switchPlaces=function(e){const t=this.parentElement;let i=this.nextElementSibling,n=e.nextElementSibling;if(this.remove(),i&&i.id===e.id)i=n;else if(n&&n.id===this.id)return(n=i)?t.insertBefore(this,n):t.append(this),void(i?t.insertBefore(e,i):t.append(e));return i?t.insertBefore(e,i):t.append(e),n?t.insertBefore(this,n):t.append(this),this}}],'js/extensions/HTMLElement/toggleClass': [["js/extensions/test-proto"],s=>{s(HTMLElement,["toggleClass"]),HTMLElement.prototype.toggleClass=function(s,t){return void 0!==t?(t?this.addClass(s):this.removeClass(s),this):(this.hasClass(s)?this.removeClass(s):this.addClass(s),this)}}],'js/extensions/HTMLElement/trigger': [["js/extensions/test-proto"],t=>{t(HTMLElement,["trigger"]),HTMLElement.prototype.trigger=function(t){for(let e of t.split(" "))this.dispatchEvent(new Event(e));return this}}],'js/extensions/HTMLElement/visible': [["js/extensions/test-proto","js/extensions/HTMLElement/css"],i=>{i(HTMLElement,["visible"]),HTMLElement.prototype.visible=function(i){return void 0===i||i?(this.css("visibility","visible"),this):this.css("visibility","hidden")}}],'js/extensions/String/createElement': [["js/extensions/html","js/extensions/test-proto"],(e,t)=>{t(String,["createElement"]),String.prototype.createElement=function(t,n){return e.tagToElement(this,t,n)}}],'js/extensions/String/hashCode': [["js/extensions/test-proto"],t=>{t(String,["hashCode"]),String.prototype.hashCode=function(){let t=0;for(let e=0,o=this.length;e<o;e++){t=(t<<5)-t+this.charCodeAt(e),t&=t}return t}}],'js/extensions/String/html': [["js/extensions/test-proto"],t=>{t(String,["html"]),String.html=((t,...n)=>String.raw(t,...n))}],'js/extensions/String/toCamelCase': [["js/extensions/test-proto"],e=>{e(String,["toCamelCase"]),String.prototype.toCamelCase=function(){return this.replace(/-([a-z,0-9])/g,e=>e[1].toUpperCase())}}],'js/extensions/String/toElement': [["js/extensions/html","js/extensions/test-proto"],(t,e)=>{e(String,["toElement"]),String.prototype.toElement=function(){return t.strToElement(this)}}],'js/extensions/test-proto': [[],()=>(r,e,o=!0)=>{for(let i of e)if(void 0!==r.prototype[i]){if(o)throw new Error(`Error: Name collision - object ${r} already have defined "${i}" !`);return!1}return!0}],'js/_main': [["js/extensions/apply"],({loadExtensions:e,applyExtensions:n,applyExtensionsExcept:l})=>{e({HTMLElement:["addClass","appendElement","appendElementTo","attr","css","dataAttr","find","findAll","forEachChild","hasClass","hideElement","html","off","on","overflownX","overflownY","removeAttr","removeClass","setFocus","showElement","toggleClass","trigger","visible","clone","switchPlaces","nextElementSiblingWithClass"],String:["hashCode","html","toElement","toCamelCase","createElement"]}).then(()=>{l("NodeList","HTMLElement",["find","findAll"],!0),l("HTMLCollection","HTMLElement",["find","findAll"],!0),n("Document",["on","off","trigger","find","findAll"]),n("Window",["on","off","trigger"]),require(["app/index"],()=>{})})}],'app/api': [["require","exports","app/_sys/pubsub","libs/signalr/signalr.min.js","app/_sys/grpc-service","app/_sys/timeout","vs/editor/editor.main"],function(e,n,t,a,o,i){"use strict";var c,r;Object.defineProperty(n,"__esModule",{value:!0}),n.ScriptId=(e=>`${r.SCRIPTS}-${e.connection}-${e.schema}-${e.id}`),n.TableId=(e=>`${r.TABLES}-${e.connection}-${e.schema}-${e.id}`),n.ViewId=(e=>`${r.VIEWS}-${e.connection}-${e.schema}-${e.id}`),n.RoutineId=(e=>`${r.ROUTINES}-${e.connection}-${e.schema}-${e.id}`),n.classes={active:"active",sticky:"sticky",docked:"docked"},function(e){e.LEFT="left",e.RIGHT="right"}(n.Position||(n.Position={})),function(e){e.DARK="dark",e.LIGHT="light"}(n.Themes||(n.Themes={})),function(e){e[e.READY=0]="READY",e[e.BUSY=1]="BUSY",e[e.ERROR=2]="ERROR",e[e.NO_CONNECTION=3]="NO_CONNECTION"}(c=n.AppStatus||(n.AppStatus={})),function(e){e.SCRIPTS="scripts",e.TABLES="tables",e.VIEWS="views",e.ROUTINES="routines",e.SEARCH="search"}(r=n.Keys||(n.Keys={})),function(e){e.PGSQL="pgsql"}(n.Languages||(n.Languages={}));const s=(new a.HubConnectionBuilder).configureLogging(a.LogLevel.None).withUrl("/connectionsHub").withAutomaticReconnect({nextRetryDelayInMilliseconds:()=>250}).build(),l=new o.GrpcService,u=async e=>{s.state!=a.HubConnectionState.Connected&&await s.start(),t.publish(t.SET_APP_STATUS,c.BUSY);try{return{ok:!0,status:200,data:await e(s)}}catch(e){return t.publish(t.SET_APP_STATUS,c.ERROR,e.message),console.error(e),{ok:!1,status:500,data:null}}},d=async e=>{s.state!=a.HubConnectionState.Connected&&await s.start();try{return{ok:!0,status:200,data:await e(s)}}catch(e){return console.error(e),{ok:!1,status:500,data:null}}};let p,S,g;n.getCurrentSchema=(()=>p),n.getCurrentConnection=(()=>S);let w=new Array,y=new Array;y[0]="rgb(255,255,255)",y[1]="rgb(0,182,192)",y[2]="rgb(0,255,128)",y[3]="rgb(128,0,64)",y[4]="rgb(0,128,0)",y[5]="rgb(128,128,0)",y[6]="rgb(255,128,255)",y[7]="rgb(0,64,0)",y[8]="rgb(128,128,128)",y[9]="rgb(255,128,128)",n.getConnectionColor=(e=>{const n=w.indexOf(e);if(-1!=n)return y[n];const t=(16777215&e.hashCode()).toString(16).toUpperCase();return"#"+"00000".substring(0,6-t.length)+t});n.initializeApi=(async()=>{(g=await(()=>u(e=>e.invoke("GetInitial")))()).ok&&(w=g.data.connections.map(e=>e.name)),t.publish(t.API_INITIAL,g)}),n.connectionIsDefined=(e=>!!(g&&g.ok&&g.data&&g.data.connections&&g.data.connections.length)&&!!g.data.connections.find(n=>n.name==e)),n.fetchConnection=(async e=>{const n=await u(async n=>JSON.parse(await n.invoke("GetConnection",e,Intl.DateTimeFormat().resolvedOptions().timeZone)));return n.data?(p=n.data.schemas.selected,S=e,n.data.connection=e,t.publish(t.CONNECTION_SET,S),n):n}),n.fetchSchema=(async e=>{let t=n.getCurrentConnection();const a=await u(async n=>JSON.parse(await n.invoke("GetSchema",t,e)));return a.data?(p=a.data.name,a.data.connection=n.getCurrentConnection(),a):null}),n.createScript=(async()=>{let e=n.getCurrentConnection(),t=n.getCurrentSchema();const a=await d(async n=>JSON.parse(await n.invoke("CreateScript",e,t)));return a.data?(a.data.connection=e,a.data.schema=t,a):null}),n.fetchScriptContent=((e,n)=>d(async t=>JSON.parse(await t.invoke("GetScriptContent",e,Number(n))))),n.saveScriptContent=((e,n,t,a)=>d(async o=>JSON.parse(await o.invoke("SaveScriptContent",e,Number(n),t,a)))),n.saveScriptScrollPosition=((e,n,t,a)=>d(async o=>JSON.parse(await o.invoke("SaveScriptScrollPosition",e,JSON.stringify({id:Number(n),scrollTop:t,scrollLeft:a}))))),n.checkItemExists=((e,n,t,a)=>d(o=>o.invoke("CheckItemExists",e,n,t,a)));const C={},h=async(e,n=!1)=>{let t=C[e];return t||(t=(()=>(new a.HubConnectionBuilder).configureLogging(a.LogLevel.None).withUrl("/executeHub").withAutomaticReconnect({nextRetryDelayInMilliseconds:()=>250}).build())(),C[e]=t),n&&t.state!=a.HubConnectionState.Connected&&await t.start(),t};n.initConnection=(async(e,n,t)=>{const a=await h(t,!0);try{return{ok:!0,status:200,data:await a.invoke("InitConnection",e,n,t)}}catch(e){return console.error(e),{ok:!1,status:500,data:null}}}),n.disposeConnection=(async e=>{const n=await h(e,!1);try{return await n.stop(),delete C[e],{ok:!0,status:200,data:null}}catch(e){return console.error(e),{ok:!1,status:500,data:null}}}),n.execute=(async e=>{let t=await h(e.id,!1);const o=(n,...t)=>{e.events[n]&&e.events[n](...t)};if(t.state!=a.HubConnectionState.Connected||void 0==t.connectionId){if(!(await n.initConnection(e.connection,e.schema,e.id)).ok)throw new Error("connection could be re-initialized");t=await h(e.id,!1)}const i=`notice-${e.id}`,c=`error-${e.id}`;t.off(i),t.off(c),t.on(i,e=>o("notice",e)),t.on(c,e=>o("error",e));const r=await t.invoke("Execute",e.content);if("404"==r.message){let a=await n.initConnection(e.connection,e.schema,e.id);try{if(!a.ok||e._call>3)throw new Error("connection could be re-initialized")}catch(e){throw t.off(i),t.off(c),e}return e._call=(void 0==e._call?0:e._call)+1,console.warn("reconnect attempt "+e._call),n.execute(e)}return t.off(i),t.off(c),r.connectionId=t.connectionId,r});const f=new i.Consumer;n.cursor=((e,n,a,i)=>f.run(async()=>{await((e,n,a,i)=>new Promise(c=>{l.serverStreaming({service:"/api.DataService/ReadPage",request:[o.GrpcType.String,o.GrpcType.Uint32,o.GrpcType.Uint32],reply:[{rn:o.GrpcType.Uint32},{data:[o.GrpcType.String]},{nullIndexes:o.GrpcType.PackedUint32}]},e,n,a).on("error",e=>{console.warn(e),setTimeout(()=>t.publish(t.FOOTER_MESSAGE,"can't load more grid data, connection may be reset, try running query again..."),250),i.end&&i.end(),c()}).on("data",e=>{if(i.row){if(e.nullIndexes&&e.nullIndexes.length)for(let n of e.nullIndexes)e.data[n]=null;i.row(e.rn,e.data)}}).on("end",()=>{i.end&&i.end(),c()})}))(e,n,a,i)}))}],'app/controls/context-menu': [["require","exports","app/_sys/pubsub"],function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContextMenu=class{constructor({id:e,items:t=[],target:i,event:n="contextmenu",menuItemsCallback:l=(e=>e),beforeOpen:o=(()=>!0),onOpen:h=(()=>{}),onClose:c=(()=>{})}){this.id=e,this.element=document.body.find("#"+e),this.element.length||(this.element=this.menuElement(e),document.body.append(this.element)),this.actions=this.getActionsContainerElement(this.element),this.onClose=c,this.event=n,this.setMenuItems(t),this.element.on("click",()=>this.close()),window.on("resize",()=>this.close()),window.on("mousedown",e=>{let t=e.composedPath();(!t.includes(this.element)&&!t.includes(this.target)&&"click"===n||!t.includes(this.element)&&"click"!==n)&&this.close()}).on("keyup",e=>{27===e.keyCode&&this.close()}),this.target=i.on(n,e=>{if(o(this,e)&&0!==Object.keys(this.items).length)if(this.isVisible)this.close();else{this.actions.html("");for(let e of l(Object.values(this.items).sort((e,t)=>e.order-t.order)))this.actions.append(e.element);this.adjust(e),e.preventDefault(),h(this)}}),s.subscribe(s.CLOSE_CONTEXT_MENU,()=>this.close())}menuSplitterElement(){return new Element}open(){this.target.trigger(this.event)}close(){this.isVisible&&(this.element.hideElement(),this.actions.html(""),this.onClose(this))}getCheckedItem(){for(let e of Object.values(this.items))if(e.checked)return e;return null}triggerById(e,t){const s=this.items[e];s&&s.action(t)}clearItems(){this.items={}}updateMenuItem(e,t){const s=this.items[e],i={...s||{},...t};return this.updateItemElement(i),void 0===i.id&&(i.id=e),this.items[e]=i,this}setMenuItems(e){this.clearItems();let t=0;for(let s of e){s.order=t++,this.updateItemElement(s);let e=s;this.items[e.id?e.id:t.toString()]=s}}adjust(e){this.element.css("top",e.y+"px").css("left",e.x+"px").visible(!1).showElement();const t=this.actions.getBoundingClientRect(),s=window.innerWidth,i=window.innerHeight,n=e.x+t.width,l=t.top+t.height;if(n>=s+1){let e=s-t.width-1;this.element.css("left",(e>0?e:0)+"px")}if(l>=i+1){let s=e.y-t.height-1;this.element.css("top",(s>0?s:0)+"px")}this.element.visible(!0)}getActionsContainerElement(e){return e}get isVisible(){return(1!==this.actions.childNodes.length||this.actions.childNodes[0].nodeType!==Node.TEXT_NODE)&&"none"!==this.element.css("display")&&0!==this.actions.childNodes.length}updateItemElement(e){let t=e;e.splitter?e.element=this.menuSplitterElement():e.element=this.menuItemElement(t).on("click",()=>{t.action(t.args,this.args)})}}}],'app/controls/footer-context-menu': [["require","exports","app/controls/context-menu"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class extends n.ContextMenu{adjust(){this.element.css("top","0").css("left","0").visible(!1).showElement();const e=this.target.getBoundingClientRect(),t=this.element.getBoundingClientRect();let n;n=e.left+t.width>=window.innerWidth?window.innerWidth-t.width:e.left,this.element.css("top",e.top-t.height+"px").css("left",n+"px").css("min-width",e.width+"px").visible(!0)}menuElement(e){return String.html`<div id=${e} class=footer-menu></div>`.toElement()}menuItemElement(e){return String.html`<div class=footer-menu-item><span>${e.checked?"&check;":""}</span> <span>${e.text}</span></div>`.toElement().attr("title",e.data?e.data:"")}}}],'app/controls/monaco-context-menu': [["require","exports","app/controls/context-menu"],function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.default=class extends t.ContextMenu{getActionsContainerElement(e){return e.find("ul")}menuElement(e){return String.html`<div id=${e} style="display: none; position: fixed;"><div class="context-view monaco-menu-container pgmenu-container"><div class=monaco-menu><div class="monaco-action-bar animated vertical"><ul class=actions-container></ul></div></div></div></div>`.toElement()}menuSplitterElement(){return String.html`<li class="action-item pgaction disabled"><a class="action-label icon separator disabled"></a></li>`.toElement()}menuItemElement(e){return String.html`<li class="action-item pgaction">${e.checked?'<span class=checked>&check;</span>':""} <a class=action-label tabindex=0>${e.text}</a> ${e.keyBindingsInfo?'<span class=keybinding>'+e.keyBindingsInfo+"</span>":""}</li>`.toElement()}}}],'app/controls/splitter': [["require","exports","app/_sys/storage"],function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i={position:null,docked:!0},o=t=>new s.default(i,t,(t,e)=>"docked"==t?JSON.parse(e):e);class n{constructor({name:t,element:e,container:s,dockPosition:n=0,resizeIndex:r,maxDelta:a=250,min:h=100,events:u={docked:()=>{},undocked:()=>{},changed:()=>{}},maxResize:d,storage:l}){this.element=e||(()=>{throw new Error("element is required")})(),this.container=s||(()=>{throw new Error("container is required")})(),this.cursor=document.body.css("cursor"),this.dockPosition=n,this.events=u,this.storage=l||(t?o(t):i),this.offset=null,this.docked=!1,this.resizeIndex=void 0!==r?r:(()=>{throw new Error("resizeIndex is required")})(),this.maxDelta=a,this.min=h,this.maxResize=d||a}updateIndexesAndAdjust(t){void 0!==t&&(this.resizeIndex=t),this.autoIndex=this.container.css(this.gridTemplateName).split(" ").indexOf("auto"),this.adjust()}start(){return this.element.on("mousedown",t=>{this.offset=this.calculateOffset(t),document.body.css("cursor",this.element.css("cursor")),this.element.addClass("split-moving");let e=this.getValuesOrSetNewPos(this.storage.position+"px");this.startingPosition=e.previousPosition}).on("mouseup",()=>{this.element.removeClass("split-moving"),this.startingPosition=null}).on("dblclick",()=>{this.isDocked?this.undockInternal():this.dock()}),document.on("mouseup",()=>{if(null===this.offset)return!0;if(this.offset=null,document.body.css("cursor",this.cursor),this.docked)return!0;const t=this.getValuesOrSetNewPos();this.storage.position=t.previousPosition,this.element.removeClass("split-moving")}).on("mousemove",t=>{if(null===this.offset)return!0;t.preventDefault(),t.stopPropagation();const e=this.getPositionFromMouseEvent(t),s=this.calculatePosition(e,t),i=this.getValuesOrSetNewPos(s+"px"),o=this.container.getBoundingClientRect();return!(this.calculateDelta(o,e)<=this.maxDelta)&&(this.getMin(e,s)<=this.min?!this.docked&&(this.dock(),!1):this.docked?(this.undockInternal(!1,this.min),!1):(this.element.addClass("split-moving"),this.container.css(this.gridTemplateName,i.values.join(" ")),this.events.changed(),!1))}),this}get isDocked(){return this.docked}dock(t=!1){const e=this.getValuesOrSetNewPos(this.dockPosition+"px");this.storage.position=this.startingPosition?this.startingPosition:e.previousPosition,this.container.css(this.gridTemplateName,e.values.join(" ")),this.docked=!0,this.storage.docked=!0,this.element.removeClass("split-moving"),t||this.events.docked()}undock(t=!1){this.undockInternal(t,this.storage.position)}undockInternal(t=!1,e=this.maxDelta){if(!this.docked)return;void 0===e&&(e=this.storage.position),this.storage.position>=e&&(e=this.storage.position);const s=this.getValuesOrSetNewPos(e+"px");this.container.css(this.gridTemplateName,s.values.join(" ")),this.docked=!1,this.storage.docked=!1,t||this.events.undocked()}move(t,e){if((e=e||this.getValuesOrSetNewPos()).previousPosition<=this.min)return!1;const s=e.previousPosition+t;this.storage.position=s,e.values[this.resizeIndex]=s+"px",this.container.css(this.gridTemplateName,e.values.join(" "))}adjust(){if(this.storage.docked)this.dock();else if(this.storage.position){let t=this.getValuesOrSetNewPos(this.storage.position+"px");this.container.css(this.gridTemplateName,t.values.join(" "))}}getCurrent(){return Number(this.getValues()[this.resizeIndex].replace("px",""))}getPositionFromMouseEvent(t){return t[this.mouseEventPositionProperty]}getValuesOrSetNewPos(t){const e=this.getValues(),s=Number(e[this.resizeIndex].replace("px",""));return t&&(e[this.resizeIndex]=t,e[this.autoIndex]="auto"),{values:e,previousPosition:s}}getValues(){return this.container.css(this.gridTemplateName).split(" ")}}e.Splitter=n;e.VerticalSplitter=class extends n{constructor(t){super(t),this.element.addClass("main-split").addClass("main-split-v"),this.mouseEventPositionProperty="clientX",this.gridTemplateName="grid-template-columns",this.updateIndexesAndAdjust()}start(){if(super.start(),this.maxResize){let t=window.innerWidth;window.on("resize",()=>{if(this.isDocked)return;let e=this.getValuesOrSetNewPos(),s=window.innerWidth,i=s-t;t=s,s-e.previousPosition<this.maxResize&&this.move(i,e)})}return this}calculatePosition(t,e){return t+this.offset}calculateOffset(t){return this.getCurrent()-this.getPositionFromMouseEvent(t)}calculateDelta(t,e){return t.width-e}getMin(t,e){return t}};e.HorizontalSplitter=class extends n{constructor(t){super(t),this.element.addClass("main-split").addClass("main-split-h"),this.mouseEventPositionProperty="clientY",this.gridTemplateName="grid-template-rows",this.updateIndexesAndAdjust()}start(){if(super.start(),this.maxResize){let t=window.innerHeight;window.on("resize",()=>{if(this.isDocked)return;let e=this.getValuesOrSetNewPos(),s=window.innerHeight,i=s-t;t=s,s-e.previousPosition<this.maxResize&&this.move(i,e)})}return this}calculatePosition(t,e){return this.offset[1]+(this.offset[0]-this.getPositionFromMouseEvent(e))}calculateDelta(t,e){return e}calculateOffset(t){return[this.getPositionFromMouseEvent(t),this.getCurrent()]}getMin(t,e){return e}}}],'app/extensions': [["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),String.prototype.formatDateString=function(){const t=new Date(this),e=new Date,r=t.getFullYear(),n=t.getDate(),o=t.getMonth();return n==e.getDate()&&o==e.getMonth()&&r==e.getFullYear()?`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}:${t.getSeconds().toString().padStart(2,"0")}`:`${r}-${(o+1).toString().padStart(2,"0")}-${n.toString().padStart(2,"0")} ${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`},e.default=null,Map.prototype.first=function(){return this.values().next()},Map.prototype.where=function*(t){for(let[e,r]of this)t(r)&&(yield r)},Map.prototype.maxBy=function(t){let e,r;for(let[n,o]of this)if(void 0===e)e=o,r=t(o);else{const n=t(o);n>r&&(e=o,r=n)}return e},Map.prototype.switchByKeys=function(t,e){const r=Array.from(this.entries()),n=Array.from(this.keys()),o=n.indexOf(t),i=n.indexOf(e);return[r[o],r[i]]=[r[i],r[o]],new Map(r)}}],'app/index': [["require","exports","app/_sys/storage","app/ui/toolbar/toolbar","app/ui/side-panel/_side-panels","app/ui/main-panel/main-panel","app/ui/footer/footer","app/controls/splitter","app/api","app/_sys/pubsub","app/extensions"],function(t,e,i,s,n,o,a,l,r,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const p=new i.default({toolbarPosition:r.Position.LEFT,sidePanelPosition:r.Position.LEFT,sidePanelWidth:250,sidePanelDocked:!0,theme:r.Themes.DARK},"main",(t,e)=>"sidePanelDocked"==t?JSON.parse(e):e),u={interval:225,counter:0,frames:["∙ ∙ ∙ ∙ ∙","● ∙ ∙ ∙ ∙","∙ ● ∙ ∙ ∙","∙ ∙ ● ∙ ∙","∙ ∙ ∙ ● ∙","∙ ∙ ∙  ∙ ●"]};new class{constructor(){this.defaultTitle="pgcode",this.initTheme(),this.initElements(),this.setStatus(r.AppStatus.BUSY,[]),this.initComponents(),this.initSplitter(this.initGrid()),this.subscribeEvents(),r.initializeApi(),document.title=this.defaultTitle}moveToolbar(t){if(p.toolbarPosition===t)return!1;p.toolbarPosition=t;const e=this.initGrid();return this.splitter.updateIndexesAndAdjust(e),!0}setStatus(t,e){if(t==r.AppStatus.READY){if(this.status==r.AppStatus.READY)return;this.status=t,this.overlay.hideElement().css("opacity","0"),clearInterval(this.loadingTimeout),document.title=e.length?`${this.defaultTitle}: ${e[0]}`:this.previousTitle}else if(t==r.AppStatus.BUSY){if(this.status==r.AppStatus.BUSY)return;this.status=t,this.overlay.showElement(),setTimeout(()=>this.overlay.css("opacity","0.4")),this.previousTitle=document.title,clearInterval(this.loadingTimeout),this.loadingTimeout=setInterval(()=>{document.title=u.frames[u.counter],u.counter++,u.counter==u.frames.length&&(u.counter=0)},u.interval)}else if(t==r.AppStatus.ERROR){if(this.status==r.AppStatus.ERROR)return;this.status=t,this.overlay.showElement(),setTimeout(()=>this.overlay.css("opacity","0.4")),this.previousTitle=document.title,clearInterval(this.loadingTimeout),document.title=e.length?`NETWORK ERROR (${e[0]})`:"NETWORK ERROR"}else if(t==r.AppStatus.NO_CONNECTION){if(this.status==r.AppStatus.NO_CONNECTION)return;this.status=t,this.overlay.hideElement().css("opacity","0"),clearInterval(this.loadingTimeout),this.previousTitle=document.title,document.title=`NO CONNECTION - ${this.defaultTitle}`}}initTheme(){this.themeLink=document.getElementById("theme"),this.themeLink.attr("href").split("?")[0]!==`css/theme-${p.theme}.css`&&this.themeLink.attr("href",`css/theme-${p.theme}.css`)}initElements(){document.body.html(String.html`<div class=overlay></div><div class=container><div></div><div></div><div></div><div></div><div></div></div>`),this.overlay=document.body.children[0],this.container=document.body.children[1]}initGrid(){const[t,e,i]=(()=>{let t=p.toolbarPosition===r.Position.LEFT,e=p.sidePanelPosition===r.Position.LEFT,i=p.sidePanelWidth;return t&&e?["toolbar side-panel main-splitter main-panel",`50px ${i}px 5px auto`,1]:t&&!e?["toolbar main-panel main-splitter side-panel",`50px auto 5px ${i}px`,3]:!t&&e?["side-panel main-splitter main-panel toolbar",`${i}px 5px auto 50px`,0]:t||e?void 0:["main-panel main-splitter side-panel toolbar",`auto 5px ${i}px 50px`,2]})();return this.container.css("grid-template-areas",`'${t}' 'footer footer footer footer`),this.container.css("grid-template-columns",e),i}initSplitter(t){this.splitter=new l.VerticalSplitter({element:this.container.children[2],container:this.container,resizeIndex:t,events:{docked:()=>d.publish([d.SIDEBAR_DOCKED,d.SPLITTER_CHANGED]),undocked:()=>d.publish([d.SIDEBAR_UNDOCKED,d.SPLITTER_CHANGED]),changed:()=>d.publish(d.SPLITTER_CHANGED)},storage:{get position(){return p.sidePanelWidth},set position(t){p.sidePanelWidth=t},get docked(){return p.sidePanelDocked},set docked(t){p.sidePanelDocked=t}}}).start()}initComponents(){const t=new o.MainPanel(this.container.children[3]);new s.default(this.container.children[0],p.toolbarPosition,this),new n.default(this.container.children[1],t),new a.default(this.container.children[4])}subscribeEvents(){d.subscribe(d.STATE_CHANGED_ON,()=>{this.splitter.isDocked&&this.splitter.undock()}),d.subscribe(d.STATE_CHANGED_OFF,()=>{this.splitter.isDocked||this.splitter.dock()}),d.subscribe(d.SET_APP_STATUS,(t,...e)=>this.setStatus(t,e)),document.body.on("contextmenu",t=>t.preventDefault())}}}],'app/ui/content/content': [["require","exports","app/ui/content/editor","app/controls/splitter","app/api","app/_sys/storage","app/_sys/pubsub","app/ui/results-pane/results-pane"],function(t,e,n,i,s,a,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const d={height:250,docked:!0},c=new a.default({splitter:{}},"content",(t,e)=>JSON.parse(e),(t,e)=>JSON.stringify(e)),l=t=>{const e=c.splitter[t];return e||d},h=(t,e)=>{const n=c.splitter,i=n[t];n[t]={...i||d,...e},c.splitter=n};class u{constructor(t){this.container=t,u.instance=this}disposeEditor(t){const e=this.getContentElement(t);e.length&&this.editor(e).dispose()}async createOrActivateContent(t,e,n,i={content:null,sticky:!1}){if(i.sticky){if(this.stickyId&&t!=this.stickyId){const t=this.getContentElement(this.stickyId);t.length&&(this.editor(t).dispose(),t.remove())}this.stickyId=t}await this.createNewContent(t,e,n,i)}async createNewContent(t,e,n,i={content:null,sticky:!1}){i.sticky&&(this.stickyId=t);const a=this.createElement(t,e,i.content,n).hideElement().attr("id",t).dataAttr("key",e).addClass("content").appendElementTo(this.container);if(!i.content&&e===s.Keys.SCRIPTS){const t=await s.fetchScriptContent(n.connection,n.id);t.ok&&this.editor(a).setContent(t.data)}}setStickStatus(t,e){this.stickyId=e?t:void 0}activate(t){const e=this.getContentElement(t);return!!e.length&&(this.active&&this.active.hideElement().removeClass(s.classes.active),this.active=e.showElement().addClass(s.classes.active),setTimeout(()=>this.editor(e).layout().focus()),o.publish(o.CONTENT_ACTIVATED,e.dataAttr("data").name),!0)}getContent(t){const e=this.getContentElement(t);if(!e.length)return null;const n=e.dataAttr("editor");return n?n.getContent():e.html().trim()}remove(t){const e=this.getContentElement(t);e.length&&(this.editor(e).dispose(),e.remove(),0==this.container.children.length&&o.publish(o.CONTENT_ACTIVATED,null))}actionRun(t){this.editor(this.active).actionRun(t)}getAllContent(){const t=new Array;for(let e of this.container.children)t.push({id:e.id,key:e.dataAttr("key"),data:e.dataAttr("data"),active:e.hasClass(s.classes.active)});return t}createElement(t,e,n,i){return e==s.Keys.SCRIPTS?this.createSplitEditor(t,s.Languages.PGSQL,n,i):String.html`<div>${e.toString()}: ${i.id}</div>`.toElement().dataAttr("data",i)}createSplitEditor(t,e,s,a){const o=String.html`<div><div class=editor></div><div></div><div class=results-pane></div></div>`.toElement().addClass("split-content").css("grid-template-rows",`auto 5px ${l(t).height}px`).dataAttr("data",a);let d;const c=new r.default(t,o.children[2],a,()=>d.undock());o.dataAttr("results",c);const u=new n.Editor(t,o.children[0],o,e,s,c);return o.dataAttr("editor",u),d=new i.HorizontalSplitter({element:o.children[1],container:o,resizeIndex:2,maxDelta:100,min:25,events:{docked:()=>{u.layout(),c.adjustGrid()},undocked:()=>{u.layout(),c.adjustGrid()},changed:()=>{u.layout(),c.adjustGrid()}},storage:{get position(){return l(t).height},set position(e){h(t,{height:e})},get docked(){return l(t).docked},set docked(e){h(t,{docked:e})}}}).start(),o}editor(t){const e=t.dataAttr("editor");return e||n.nullEditor}getContentElement(t){return this.container.find("#"+t)}}e.default=u}],'app/ui/content/editor': [["require","exports","app/api","app/_sys/pubsub","app/_sys/timeout","app/ui/content/monaco-config"],function(t,e,i,n,o,s){"use strict";var a;Object.defineProperty(e,"__esModule",{value:!0}),e.nullEditor=new class{dispose(){return this}layout(){return this}focus(){return this}setContent(t){return this}getContent(){return null}actionRun(t){return this}},function(t){t[t.Exe=0]="Exe"}(a||(a={}));e.Editor=class{constructor(t,e,i,n,o,a){this.tempViewState=null,this.executionDisabled=!1,this.id=t,this.results=a,this.data=i.dataAttr("data"),this.container=e,this.content=i;const c=String.html`<div style="position: fixed;"></div>`.toElement();this.container.append(c),this.monaco=s.createEditor(c,n),this.language=n,o&&this.setContent(o),this.selectionDecorations=[],this.initActions(),this.initMonacoEvents(),this.subscribeToEvents(),this.initConnection()}dispose(){return this.monaco.dispose(),i.disposeConnection(this.id),this}layout(){return this.content.hasClass(i.classes.active)?(this.monaco.layout({height:this.container.clientHeight,width:this.container.clientWidth}),this):this}focus(){return this.monaco.hasTextFocus()||this.monaco.focus(),this}setContent(t){return null!=t.content&&(this.monaco.setValue(t.content),this.content.dataAttr("contentHash",t.content.hashCode())),t.viewState&&(this.monaco.restoreViewState(t.viewState),this.content.dataAttr("viewStateHash",JSON.stringify(t.viewState).hashCode())),t.scrollPosition&&(this.content.dataAttr("scrollTop",t.scrollPosition.scrollTop),this.content.dataAttr("scrollLeft",t.scrollPosition.scrollLeft),this.monaco.setScrollPosition(t.scrollPosition)),setTimeout(()=>{this.renumberSelection()},225),this}getContent(){return this.monaco.getValue()}actionRun(t){return this.monaco.getAction(t).run(),this}subscribeToEvents(){window.on("resize",()=>this.initiateLayout()),n.subscribe([n.SIDEBAR_DOCKED,n.SPLITTER_CHANGED,n.SIDEBAR_UNDOCKED],()=>this.initiateLayout()),n.subscribe(n.FOOTER_MESSAGE_DISMISSED,t=>{setTimeout(()=>{this.tempViewState&&t==a.Exe&&(this.monaco.restoreViewState(this.tempViewState),this.tempViewState=null)})})}initActions(){this.monaco.addAction({id:s.commandIds.execute,label:"Execute",keybindings:[monaco.KeyCode.F5],precondition:null,keybindingContext:null,contextMenuGroupId:"execution",contextMenuOrder:1.5,run:()=>this.execute()}),this.monaco.addAction({id:s.commandIds.selectAll,label:"Select All",keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_A],precondition:null,keybindingContext:null,contextMenuGroupId:"9_cutcopypaste",contextMenuOrder:2,run:t=>{t.trigger("pgcode-editor","selectAll",null)}})}initMonacoEvents(){this.monaco.onDidChangeModelContent(()=>this.initiateSaveContent()),this.monaco.onDidChangeCursorPosition(()=>this.initiateSaveContent()),this.monaco.onDidScrollChange(()=>{this.renumberSelection(),this.initiateSaveScroll()}),this.monaco.onDidChangeCursorSelection(t=>{t.selection.isEmpty()?this.selectionDecorations=this.monaco.deltaDecorations(this.selectionDecorations,[{range:t.selection,options:{isWholeLine:!0,glyphMarginClassName:"current-line-decoration"}}]):this.selectionDecorations=this.monaco.deltaDecorations(this.selectionDecorations,[{range:t.selection,options:{isWholeLine:!0,glyphMarginClassName:"selection-decoration"}}]),this.renumberSelection()}),this.monaco.onKeyDown(()=>n.publish(n.DISMISS_FOOTER_MESSAGE))}async initConnection(){try{(await i.initConnection(this.data.connection,this.data.schema,this.id)).ok?this.executionDisabled=!1:this.executionDisabled=!0}catch(t){this.executionDisabled=!0}return this.executionDisabled?this.results.setDisconnected():this.results.setReady(),!this.executionDisabled}execute(){if(this.executionDisabled)n.publish(n.FOOTER_MESSAGE,"execution has been disabled, your connection may be broken, try restarting application");else{const t=this.monaco.getSelection();if(t.isEmpty())this.tempViewState=this.monaco.saveViewState(),n.publish(n.FOOTER_MESSAGE,"Hit F5 again to execute or any other key to continue...",a.Exe),this.actionRun(s.commandIds.selectAll);else{const e=this.monaco.getModel().getValueInRange(t);this.results.start(e,t),i.execute({connection:this.data.connection,schema:this.data.schema,id:this.id,content:e,events:{error:t=>this.results.error(t),notice:t=>this.results.notice(t)}}).then(t=>this.results.end(t))}}}initiateLayout(){return o.timeout(()=>this.layout(),25,`${this.id}-editor-layout`),this}renumberSelection(){o.timeout(()=>{const t=this.monaco.getSelection();if(!t.isEmpty())for(let e of this.container.querySelectorAll(".selection-decoration")){let i=e.nextElementSiblingWithClass("line-numbers").html();isNaN(i)||e.html(`${i-t.startLineNumber+1}`)}},25,`${this.id}-renumber-selection`)}initiateSaveContent(){o.timeout(()=>{const t=this.monaco.getPosition(),e=this.monaco.getSelection();let i=0;e.isEmpty()||(i=this.monaco.getModel().getValueInRange(e).length),n.publish(n.EDITOR_POSITION,this.language,t.lineNumber,t.column,i)},50,`${this.id}-editor-position`),o.timeoutAsync(async()=>{if(this.tempViewState)return;let t=this.monaco.getValue(),e=JSON.stringify(this.monaco.saveViewState());const o=t.hashCode(),s=e.hashCode();if(o===this.content.dataAttr("contentHash")&&(t=null),s===this.content.dataAttr("viewStateHash")&&(e=null),null!==t||null!=e){let o=await i.saveScriptContent(this.data.connection,this.data.id,t,e);o.ok&&(this.data.timestamp=o.data,n.publish(n.SCRIPT_UPDATED,this.data))}null!=t&&this.content.dataAttr("contentHash",o),null!=e&&this.content.dataAttr("viewStateHash",s)},250,`${this.id}-editor-save`)}initiateSaveScroll(){o.timeoutAsync(async()=>{let t=this.monaco.getScrollTop(),e=this.monaco.getScrollLeft();t==this.content.dataAttr("scrollTop")&&e==this.content.dataAttr("scrollLeft")||(this.content.dataAttr("scrollTop",t).dataAttr("scrollLeft",e),await i.saveScriptScrollPosition(this.data.connection,this.data.id,t,e))},250,`${this.id}-editor-scroll`)}}}],'app/ui/content/monaco-config': [["require","exports","vs/editor/editor.main"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o;t.commandIds={selectAll:"pgcode.selectAll",execute:"pgcode.execute"},t.createEditor=((e,t)=>{let o=monaco.editor.create(e,{language:t,theme:"vs-dark",renderWhitespace:"all",automaticLayout:!1,selectOnLineNumbers:!0,glyphMargin:!0,smoothScrolling:!0});return delete(o=o)._actions["editor.action.insertCursorAbove"],delete o._actions["editor.action.insertCursorBelow"],delete o._actions["editor.action.addCursorsToBottom"],delete o._actions["editor.action.insertCursorAtEndOfEachLineSelected"],delete o._actions["editor.action.addCursorsToTop"],delete o._actions["editor.action.copyLinesDownAction"],delete o._actions["editor.action.copyLinesUpAction"],delete o._actions["editor.action.clipboardCopyWithSyntaxHighlightingAction"],delete o._actions.cursorRedo,delete o._actions.cursorUndo,delete o._actions.deleteAllLeft,delete o._actions.deleteAllRight,delete o._actions["editor.action.deleteLines"],delete o._actions["editor.action.forceRetokenize"],delete o._actions["editor.action.inspectTokens"],delete o._actions["editor.action.duplicateSelection"],delete o._actions["editor.action.smartSelect.expand"],delete o._actions["editor.foldAllBlockComments"],delete o._actions["editor.foldAllMarkerRegions"],delete o._actions["editor.foldLevel1"],delete o._actions["editor.foldLevel2"],delete o._actions["editor.foldLevel3"],delete o._actions["editor.foldLevel4"],delete o._actions["editor.foldLevel5"],delete o._actions["editor.foldLevel6"],delete o._actions["editor.foldLevel7"],delete o._actions["editor.unfoldRecursively"],delete o._actions["editor.action.marker.next"],delete o._actions["editor.action.marker.nextInFiles"],delete o._actions["editor.action.marker.prev"],delete o._actions["editor.action.marker.prevInFiles"],delete o._actions["editor.action.indentLines"],delete o._actions["editor.action.insertLineBefore"],delete o._actions["editor.action.insertLineAfter"],delete o._actions["editor.action.joinLines"],delete o._actions["editor.action.moveCarretLeftAction"],delete o._actions["editor.action.moveCarretRightAction"],delete o._actions["editor.action.moveLinesDownAction"],delete o._actions["editor.action.moveLinesUpAction"],delete o._actions["editor.action.openLink"],delete o._actions["editor.action.outdentLines"],delete o._actions["editor.action.showAccessibilityHelp"],delete o._actions["editor.action.showDefinitionPreviewHover"],delete o._actions["editor.action.showHover"],delete o._actions["editor.action.smartSelect.shrink"],delete o._actions["editor.action.sortLinesAscending"],delete o._actions["editor.action.sortLinesDescending"],delete o._actions["editor.action.toggleTabFocusMode"],delete o._actions["editor.action.transpose"],delete o._actions["editor.action.wordHighlight.trigger"],delete o._actions["editor.unfoldAllMarkerRegions"],delete o._actions["editor.unfoldRecursively"],o})}],'app/ui/footer/footer': [["require","exports","app/controls/footer-context-menu","app/controls/monaco-context-menu","app/_sys/storage","app/api","app/_sys/pubsub","app/ui/content/content","app/ui/main-panel/main-panel"],function(t,e,n,s,i,o,c,a,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const d=new i.default({connection:null});e.default=class{constructor(t){this.selectedConnection=null,this.connectionMenu=null,this.schemasMenu=null,this.msgMode=!1,this.msgArgs=null,this.footer=t.addClass("footer").html(String.html`<div class=connections><i class=icon-database></i> <span></span></div><div class="info clickable"><span></span></div><div class="schemas clickable"><i class=icon-search></i> <span></span></div><div class="content clickable"><i class=icon-doc-text></i> <span></span></div><div class="lang clickable"><span></span></div><div class=msg></div><div class="editor clickable"><span></span></div><div class="user clickable"><span></span></div><div class="version clickable" title="current version"><span></span></div><div class="feed clickable" title="Send feedback">&#128526;</div>`),this.initConnections(t),this.initInfo(t),this.initFeedbackMenu(t),this.user=t.find(".user>span"),this.content=t.find(".content"),this.editor=t.find(".editor>span").on("click",()=>a.default.instance.actionRun("editor.action.gotoLine")),this.lang=t.find(".lang>span"),this.msg=t.find(".msg"),this.version=t.find(".version>span"),this.subscribeContentActivated(),this.subscribeEditorPosition(),this.initFooterContextMenu(),this.subscribeFooterMessage()}subscribeFooterMessage(){const t=()=>{this.msgMode&&(this.msgMode=!1,this.msg.html(""),this.footer.findAll("div:not(.connections):not(.msg):not(.feed)").css("display",""),this.adjustWidths(!1),c.publish(c.FOOTER_MESSAGE_DISMISSED,...this.msgArgs),this.msgArgs=null)};c.subscribe(c.DISMISS_FOOTER_MESSAGE,()=>t()),c.subscribe(c.FOOTER_MESSAGE,(t,...e)=>{this.msg.html(t),this.msgMode=!0,this.msgArgs=e,this.adjustWidths(!0),this.footer.findAll("div:not(.connections):not(.msg):not(.feed)").css("display","none")}),window.on("click keydown contextmenu",()=>t())}subscribeContentActivated(){c.subscribe(c.CONTENT_ACTIVATED,t=>{t?this.content.showElement().find("span").html(t):(this.content.hideElement(),this.editor.html(""),this.lang.html(""))})}subscribeEditorPosition(){c.subscribe(c.EDITOR_POSITION,(t,e,n,s)=>{let i="";s&&(i=`(${s} selected)`),this.editor.html(`Ln ${e}, Col ${n} ${i}`),this.lang.html(t)})}initFooterContextMenu(){new n.default({id:"content-footer-menu",event:"click",target:this.content,items:[],beforeOpen:t=>{t.clearItems();for(let e of a.default.instance.getAllContent())t.updateMenuItem(e.id,{text:`${e.data.name} @ ${e.data.connection} / ${e.data.schema}`,checked:e.active,action:()=>l.MainPanel.instance.activateById(e.id)});return!0}})}initConnections(t){this.connections=t.find(".connections"),this.schemas=t.find(".schemas"),c.subscribe(c.API_INITIAL,t=>{if(!t.ok)return void this.connections.find("span").html("¯\\_(ツ)_/¯");if(this.user.html(t.data.user).attr("title",`signed in into pgcode as user ${t.data.user}`),this.version.html(t.data.version),this.schemasMenu=new n.default({id:"schema-footer-menu",event:"click",target:this.schemas,items:[]}),1===t.data.connections.length)return this.selectConnection(t.data.connections[0]),void this.connections.css("cursor","initial");const e=new Array;for(let n of t.data.connections)e.push({id:n.name,text:n.name,data:this.formatTitleFromConn(n),action:()=>this.selectConnection(n)});if(this.connectionMenu=new n.default({id:"conn-footer-menu",event:"click",target:this.connections,items:e,menuItemsCallback:t=>{for(let e of t)e.element.find("span:nth-child(2)").css("border-left",`2px solid ${o.getConnectionColor(e.text)}`).css("padding-left","5px");return t}}),d.connection){const e=d.connection,n=t.data.connections.filter(t=>t.name===e);n.length?this.selectConnection(n[0]):(d.connection=e,this.selectConnection())}else this.selectConnection()})}initInfo(t){this.info=t.find(".info");const e=String.html`<input id=footer-copy type=text class=out-of-viewport>`.toElement().appendElementTo(document.body);new s.default({id:"info-ctx-menu",target:this.info,beforeOpen:t=>{const n=window.getSelection(),s=n.toString();return!(!s||n.anchorNode.parentElement.parentElement!=this.info&&n.anchorNode!=this.info||(t.updateMenuItem("copy",{text:`copy "${s}"`,action:()=>{e.value=s,e.select(),document.execCommand("copy"),e.value=""}}),0))}})}initFeedbackMenu(t){const e=t.find(".feed");new n.default({id:"feed-footer-menu",event:"click",target:e,items:[{text:"Open New Issue",data:"Opens a new window to create a new issue on GitHub repository",action:()=>window.open("https://github.com/vbilopav/sfcode/issues/new","_blank").focus()},{text:"Tweet Your Feedback",data:"Opens a new window to send a Tweeter feedback",action:()=>window.open("https://twitter.com/intent/tweet?text="+encodeURI("Say something about @pgcode")+"&hashtags=pgcode","_blank").focus()}],onOpen:()=>e.html("&#128522;"),onClose:()=>e.html("&#128526;")})}async selectConnection(t){if(this.selectedConnection===t)return;this.selectedConnection=t;const e=t?t.name:null;if(t){const n=this.formatTitleFromConn(t);if(this.info.visible(!1),this.schemas.visible(!1),this.connections.find("span").html(e).attr("title",n),this.info.find("span").html(`v${t.version}&nbsp;&nbsp;//&nbsp;&nbsp;${t.user}@${t.host}:${t.port}/${t.database}`),this.info.attr("title",n),this.info.visible(!0),this.schemas.visible(!0),this.connectionMenu){const t=this.connectionMenu.getCheckedItem();t&&this.connectionMenu.updateMenuItem(t.id,{checked:!1}),this.connectionMenu.updateMenuItem(e,{checked:!0})}d.connection=e;const s=await o.fetchConnection(e);if(s.ok){const t=new Array;for(let e of s.data.schemas.names)t.push({id:e,text:e,checked:s.data.schemas.selected===e,action:()=>{this.selectSchema(e),this.fetchSchema(e)}});this.schemasMenu.setMenuItems(t),this.schemas.showElement().find("span").html(s.data.schemas.selected),this.selectSchema(s.data.schemas.selected),c.publish(c.SCHEMA_CHANGED,s.data,s.data.schemas.selected),c.publish(c.SET_APP_STATUS,o.AppStatus.READY,e)}}else this.connections.find("span").html("Connection not selected").attr("title","Click here to select from available connections..."),this.info.find("span").html(""),this.info.attr("title","no connection..."),this.schemas.showElement(!1),d.connection=null,c.publish(c.SET_APP_STATUS,o.AppStatus.NO_CONNECTION)}selectSchema(t){const e=this.schemasMenu.getCheckedItem();if(e)this.schemasMenu.updateMenuItem(e.id,{checked:!1});else if(e.id===t)return;this.schemasMenu.updateMenuItem(t,{checked:!0}),this.schemas.showElement().find("span").html(t)}async fetchSchema(t){const e=await o.fetchSchema(t);c.publish(c.SCHEMA_CHANGED,e.data,e.data.name),c.publish(c.SET_APP_STATUS,o.AppStatus.READY)}adjustWidths(t=!1){t?this.footer.css("grid-template-columns","min-content 0px 0px 0px 0px 0px auto 0px 0px 0px 27px"):this.footer.css("grid-template-columns","min-content fit-content(40%) fit-content(40%) fit-content(40%) fit-content(40%) auto auto min-content min-content min-content 27px")}formatTitleFromConn(t){return`PostgreSQL ${t.version}\nHost: ${t.host}\nPort: ${t.port}\nDatabase: ${t.database}\nUser: ${t.user}`}}}],'app/ui/item-tooltip': [["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=(e,t,n)=>`${e}\n`+`connection: ${n.connection}\n`+`schema: ${n.schema}`+(t?"\n"+t:"")+(n.comment?`\n\n${n.comment}`:"");t.routineTitle=(e=>n(`${e.language.toLowerCase()} ${e.type.toLowerCase()} ${e.name} returns ${e.returns}`,null,e)),t.scriptTitle=(e=>n(`script: ${e.name}`,`modified: ${e.timestamp.formatDateString()}`,e)),t.tableTitle=(e=>n(`table: ${e.name}`,`estimated count ≈ ${e.estimate}`,e)),t.viewTitle=(e=>n(`view: ${e.name}`,`estimated count ≈ ${e.estimate}`,e))}],'app/ui/main-panel/main-panel': [["require","exports","app/_sys/storage","app/_sys/pubsub","app/ui/main-panel/tabs","app/controls/monaco-context-menu","app/ui/content/content","app/api","app/_sys/timeout"],function(t,e,s,i,a,n,c,r,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const h=new s.default({stickyId:null,activeId:null,items:[]},"tabs",(t,e)=>"items"===t?JSON.parse(e):e,(t,e)=>"items"===t?JSON.stringify(e):e),d=t=>setTimeout(()=>h.items=Array.from(t.entries(),(t,e)=>[t[0],{id:t[1].id,key:t[1].key,timestamp:t[1].timestamp,data:t[1].data}]));let l;class m{constructor(t){this.headerRows=1,this.items=new Map,this.element=t.addClass("main-panel").html(String.html`<div></div><div></div>`),this.tabs=t.children[0],l=new n.default({id:"main-panel-tabs-ctx-menu",items:[{text:"Close",action:(t,e)=>this.removeByTab(e)},{splitter:!0},{text:"Close Others",action:(t,e)=>this.removeExceptTab(e)},{text:"Close to the Right",action:(t,e)=>this.removeToTheRightByTab(e)},{text:"Close to the Left",action:(t,e)=>this.removeToTheLeftByTab(e)},{splitter:!0},{text:"Copy content",action:(t,e)=>this.copyContentByTab(e)}],target:this.tabs,beforeOpen:(t,e)=>{for(let s of e.composedPath()){if(s.hasClass("main-panel"))return!1;if(s.hasClass("tab"))return t.args=s,!0}return!1}}),this.content=new c.default(t.children[1]),this.initHeaderAdjustment(),i.subscribe(i.SCHEMA_CHANGED,(t,e)=>this.schemaChanged(e,t.connection)),i.subscribe(i.SCRIPT_UPDATED,t=>{null!=t.timestamp?a.updateScriptTabElement(this.items,t):this.removeByDataItem(t)}),i.subscribe(i.API_INITIAL,()=>this.restoreItems()),this.hiddenCopy=String.html`<textarea id=main-panel-hidden-copy type=text class=out-of-viewport></textarea>`.toElement().appendElementTo(document.body),m.instance=this}unstickById(t){this.stickyTab&&this.stickyTab.id==t&&(this.stickyTab.removeClass(r.classes.sticky),this.stickyTab=null,h.stickyId=null,this.content.setStickStatus(t,!1))}activate(t,e,s,i){const a=this.items.get(t);if(a)this.activateByTab(a.tab);else{this.content.createOrActivateContent(t,e,s,i);const n=this.createNewTab(t,e,s);i.sticky?this.stickyTab?(this.items.delete(this.stickyTab.id),this.content.remove(this.stickyTab.id),h.stickyId=null,this.stickyTab.replaceWith(this.makeStickyTab(n))):this.makeStickyTab(n).appendElementTo(this.tabs):n.appendElementTo(this.tabs),this.items.set(t,{tab:n,id:t,key:e,data:s}),this.activateByTab(n,a)}d(this.items)}activateById(t){this.activateByTab(this.tabs.find("#"+t))}async restoreItems(){const t=h.stickyId,e=h.activeId;for(let[s,i]of h.items){if(!r.connectionIsDefined(i.data.connection))continue;const a=await r.checkItemExists(i.data.connection,i.data.schema,i.key,String(i.data.id));if(!a.ok||a.ok&&0==a.data)continue;this.content.createNewContent(s,i.key,i.data);const n=this.createNewTab(s,i.key,i.data).appendElementTo(this.tabs);s===t&&(this.stickyTab=n.addClass(r.classes.sticky)),s===e&&(this.activeTab=n.addClass(r.classes.active)),this.items.set(s,{tab:n,...i})}this.activeTab&&(this.activated(this.activeTab.id),this.initiateHeaderAdjust())}schemaChanged(t,e){if(!this.activeTab)return;const s=this.items.get(this.activeTab.id);s&&s.data.schema===t&&s.data.connection===e&&setTimeout(()=>i.publish(i.TAB_SELECTED,s.id,s.key,s.data.schema,s.data.connection))}activateByTab(t,e){for(let t of this.tabs.children)if(t.hasClass(r.classes.active)){t.removeClass(r.classes.active);let e=this.items.get(t.id);h.activeId=null,i.publish(i.TAB_UNSELECTED,e.id,e.key)}this.activeTab=t.addClass(r.classes.active),h.activeId=t.id,this.activated(t.id,e),this.initiateHeaderAdjust()}activated(t,e){e||(e=this.items.get(t)),e.timestamp=(new Date).getTime(),this.content.activate(t),i.publish(i.TAB_SELECTED,e.id,e.key,e.data.schema,e.data.connection)}removeByTab(t){const e=t.id,s=t.hasClass(r.classes.active),a=t.hasClass(r.classes.sticky),n=this.items.get(e);if(this.items.delete(e),t.remove(),this.content.remove(e),a&&(this.stickyTab=null,h.stickyId=null),!s)return;if(h.activeId=null,i.publish(i.TAB_UNSELECTED,n.id,n.key),!this.items.size)return;let c=this.items.maxBy(t=>t.timestamp);this.activateByTab(c.tab,c)}removeByDataItem(t){const e=this.items.where(e=>e.data.id==t.id).next().value;e&&this.removeByTab(e.tab)}createNewTab(t,e,s){return a.createTabElement(t,e,s).on("click",t=>this.tabClick(t)).on("dblclick",t=>this.tabDblClick(t)).on("dragstart",t=>{this.activateByTab(t.currentTarget),t.dataTransfer.setData("tab-id",t.currentTarget.id)}).on("dragover",t=>t.preventDefault()).on("dragenter",t=>t.currentTarget.addClass("drop-target")).on("dragleave",t=>t.currentTarget.removeClass("drop-target")).on("drop",t=>{t.preventDefault();const e=t.currentTarget.removeClass("drop-target"),s=this.items.get(t.dataTransfer.getData("tab-id")).tab;s.switchPlaces(e),d(this.items.switchByKeys(e.id,s.id))})}makeStickyTab(t){return this.stickyTab=t,h.stickyId=t.id,this.content.setStickStatus(t.id,!0),t.addClass(r.classes.sticky)}tabClick(t){const e=t.target,s=t.currentTarget;if(e.hasClass("close"))return this.removeByTab(s),void d(this.items);s.hasClass(r.classes.active)||this.activateByTab(s),d(this.items)}tabDblClick(t){const e=t.currentTarget;e.hasClass(r.classes.sticky)&&(e.removeClass(r.classes.sticky),this.stickyTab=null,h.stickyId=null,this.content.setStickStatus(e.id,!1))}initHeaderAdjustment(){this.headerHeight=Number(this.element.css("grid-template-rows").split(" ")[0].replace("px","")),window.on("resize",()=>this.initiateHeaderAdjust()),i.subscribe(i.SPLITTER_CHANGED,()=>this.initiateHeaderAdjust())}initiateHeaderAdjust(){o.timeout(()=>this.adjustHeaderHeight(),10,"main-panel-adjust")}adjustHeaderHeight(){let t,e=1;for(let s of this.tabs.children){let i=s.getBoundingClientRect().top;void 0!=t&&t<i&&e++,t=i,s.dataAttr("row",e)}this.activeTab&&(this.activeTab.dataAttr("row")!=e?this.activeTab.addClass("upper-row"):this.activeTab.removeClass("upper-row")),e!=this.headerRows&&(this.element.css("grid-template-rows",`${e*this.headerHeight}px auto`),this.headerRows=e)}removeExceptTab(t){const e=Array();for(let s of t.parentElement.children)s&&s.hasClass("tab")&&s.id!=t.id&&e.push(s);e.length&&(e.forEach(t=>this.removeByTab(t)),d(this.items))}removeToTheRightByTab(t){this.removeSiblingsByTab(t,"nextElementSibling")}removeToTheLeftByTab(t){this.removeSiblingsByTab(t,"previousElementSibling")}removeSiblingsByTab(t,e){const s=Array();for(;(t=t[e])&&t.hasClass("tab");)s.push(t);s.length&&(s.forEach(t=>this.removeByTab(t)),d(this.items))}copyContentByTab(t){this.hiddenCopy.html(this.content.getContent(t.id)),this.hiddenCopy.select(),document.execCommand("copy"),this.hiddenCopy.html("")}}e.MainPanel=m}],'app/ui/main-panel/tabs': [["require","exports","app/api","app/ui/item-tooltip"],function(t,e,i,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createTabElement=((t,e,n)=>{let s,l,c=n.name;return e===i.Keys.SCRIPTS?(s="icon-doc-text",l=a.scriptTitle(n)):e===i.Keys.TABLES?(s="icon-database",l=a.tableTitle(n)):e===i.Keys.VIEWS?(s="icon-database",l=a.viewTitle(n)):e===i.Keys.ROUTINES&&(s="icon-database",l=a.routineTitle(n)),`\n        <div class="tab" draggable="true">\n            <i class=${s}></i>\n            <span class="title">${c}</span>\n            <i class="close" title="close">&#10006</i>\n            <div class="stripe" style="background-color: ${i.getConnectionColor(n.connection)}"></div>\n        </div>`.toElement().attr("id",t).attr("title",l)}),e.updateScriptTabElement=((t,e)=>{const n=t.get(i.ScriptId(e));n&&n.tab.attr("title",a.scriptTitle(e))})}],'app/ui/results-pane/grid': [["require","exports","app/api","app/_sys/timeout"],function(t,e,s,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t,e,s){this.rows=new Map,this.table=null,this.header=null,this.headerHeight=null,this.rowHeight=25,this.toMove=null,this.moving=!1,this.response=null,this.start=null,this.end=null,this.rowWidths=new Array,this.scroll=null,this.scroller=null,this.id=t,this.element=e,this.resultsPane=s,window.on("mousedown",t=>this.mousedown(t)).on("mouseup",t=>this.mouseup(t)).on("mousemove",t=>this.mousemove(t)).on("resize",()=>this.adjust()),this.scrollConsumer=new i.Consumer(()=>this.scrollTable(),5)}init(){this.element.html(""),this.table=document.createElement("div").appendElementTo(this.element).addClass("table").on("wheel",t=>this.onTableWheel(t)),this.scroll=document.createElement("div").addClass("v-scroll").appendElementTo(this.element).on("scroll",t=>this.onTableScroll()),this.scroller=document.createElement("div").appendElementTo(this.scroll),this.header=null,this.start=null,this.end=null,this.rows.clear(),this.scrollConsumer.stop(),this.rowWidths=new Array}done(t){if(this.response=Object.assign({},t),this.addHeader(),this.header){let t=0;for(let e of this.header.children){let s;this.rowWidths[t++]=e.clientWidth,s=1==t?8*this.response.rowsAffected.toString().length+"px":e.clientWidth+"px",e.css("min-width",s).css("max-width",s),this.table.findAll(`div.tr > div.td${e.dataAttr("col")}`).css("min-width",s).css("max-width",s)}}this.scroller.css("height",this.response.rowsAffected*this.rowHeight+this.headerHeight+"px"),this.initial=!0,this.scrollTable().then(()=>this.adjustGridScrollBars())}adjust(){this.onTableScroll(),this.adjustGridScrollBars()}addHeader(){let t=0;if(this.header=document.createElement("div").appendElementTo(this.table).addClass("th").dataAttr("row",0),document.createElement("div").appendElementTo(this.header).addClass("td").addClass(`td${++t}`).dataAttr("col",t).on("mousemove",t=>this.headerCellMousemove(t)).on("mouseenter",t=>this.cellMouseEnter(t.currentTarget)).on("mouseleave",t=>this.cellMouseLeave(t.currentTarget)),this.response.header)for(let e of this.response.header)document.createElement("div").html(`<div>${e.name}</div><div>${e.type}</div>`).appendElementTo(this.header).addClass("td").addClass(`td${++t}`).dataAttr("col",t).on("mousemove",t=>this.headerCellMousemove(t)).on("mouseenter",t=>this.cellMouseEnter(t.currentTarget)).on("mouseleave",t=>this.cellMouseLeave(t.currentTarget));this.headerHeight=this.header.clientHeight}newRow(t,e){let s=0;const i=document.createElement("div").addClass("tr").addClass(`tr${t}`).dataAttr("row",t);let o=document.createElement("div").html(`${t}`).appendElementTo(i).addClass("td").addClass("th").addClass(`td${++s}`).dataAttr("col",s).dataAttr("row",t).on("mouseenter",t=>this.cellMouseEnter(t.currentTarget)).on("mouseleave",t=>this.cellMouseLeave(t.currentTarget));if(this.rowWidths.length){let t=this.rowWidths[s-1]+"px";o.css("min-width",t).css("max-width",t)}for(let o of e){let e=document.createElement("div").html(`${null==o?"NULL":o}`).appendElementTo(i).addClass("td").addClass(`td${++s}`).dataAttr("col",s).dataAttr("row",t).on("mouseenter",t=>this.cellMouseEnter(t.currentTarget)).on("mouseleave",t=>this.cellMouseLeave(t.currentTarget));if(null==o&&e.addClass("null"),this.rowWidths.length){let t=this.rowWidths[s-1]+"px";e.css("min-width",t).css("max-width",t)}}return i}adjustGridScrollBars(){this.table&&(this.scroll.showElement(),this.table.css("height",this.element.clientHeight+"px"),this.scroller.clientHeight>this.table.clientHeight?(this.scroll.showElement(),this.element.css("grid-template-columns","auto 16px")):(this.scroll.hideElement(),this.element.css("grid-template-columns","auto 0px")),this.header.clientWidth>this.element.clientWidth?this.table.css("overflow-x","scroll"):this.table.css("overflow-x","hidden"))}async onTableWheel(t){null!=this.scroll&&(this.scroll.scrollTop=this.scroll.scrollTop+t.deltaY)}onTableScroll(){this.response&&this.scrollConsumer.run()}async scrollTable(){const{first:t,last:e}=this.getActualGridSize();t==this.start&&e==this.end||(t==this.start&&e<this.end||t>this.start&&e<this.end||t>this.start&&e==this.end?this.performScroll():(this.initial||(this.resultsPane.footer="⏩ ⏩ ⏩ seeking ..."),(t>this.end&&e>this.end||t<this.start&&e<this.start)&&await this.removeAndLoadAllRows(t,e),t==this.end&&e>this.end||t<this.end&&t>this.start&&e>this.end?await this.removeAndLoadTopRows(t,e):t==this.start&&e>this.end&&e>this.end?await this.loadTopRows(t,e):t<this.start&&e<this.end&&e>this.start||t<this.start&&e==this.start?await this.removeAndLoadBottomRows(t,e):t<this.start&&e==this.end?await this.loadBottomRows(t,e):t<this.start&&e>this.end&&(await this.loadTopRows(t,e),await this.loadBottomRows(t,e)),this.initial?this.initial=!1:this.resultsPane.footer="✔️ Ready",this.performScroll()))}getActualGridSize(){let t=Math.trunc((this.scroll.scrollTop-this.headerHeight)/this.rowHeight)+1,e=Math.trunc((this.scroll.scrollTop-this.headerHeight+this.scroll.offsetHeight)/this.rowHeight)+1;return t<1&&(t=1),e>this.response.rowsAffected&&(e=this.response.rowsAffected),{first:t,last:e}}performScroll(){this.start+(this.end-this.start)/2<this.response.rowsAffected/2?this.table.scrollTo({top:(this.start-1)*this.rowHeight+this.scroll.scrollTop%this.rowHeight,behavior:"auto"}):this.table.scrollTo({top:this.start*this.rowHeight+this.scroll.scrollTop%this.rowHeight,behavior:"auto"})}async removeAndLoadAllRows(t,e){const i=Array.from(this.rows.keys());let o=i.length;if(await new Promise(l=>{s.cursor(this.response.connectionId,t,e,{end:()=>l(),row:(t,e)=>{const s=this.newRow(t,e);if(s.appendElementTo(this.table),this.rows.set(t,s),o){let t=i.pop();const e=this.rows.get(t);e&&(e.remove(),this.rows.delete(t),o--)}}})}),o)for(let t of i){const e=this.rows.get(t);e&&(e.remove(),this.rows.delete(t))}this.start=t,this.end=e}async removeAndLoadTopRows(t,e){await new Promise(t=>{s.cursor(this.response.connectionId,this.end+1,e,{end:()=>t(),row:(t,e)=>{const s=this.newRow(t,e);s.appendElementTo(this.table);const i=this.rows.get(this.start);i&&(i.remove(),this.rows.delete(this.start),this.start++),t>this.end&&(this.end=t),this.rows.set(t,s)}})})}async loadTopRows(t,e){await new Promise(t=>{s.cursor(this.response.connectionId,this.end+1,e,{end:()=>t(),row:(t,e)=>{const s=this.newRow(t,e);s.appendElementTo(this.table),t>this.end&&(this.end=t),this.rows.set(t,s)}})})}async removeAndLoadBottomRows(t,e){await new Promise(e=>{let i;s.cursor(this.response.connectionId,t,this.start-1,{end:()=>e(),row:(t,e)=>{let s=this.newRow(t,e);i?i.after(s):this.header.after(s),i=s;const o=this.rows.get(this.end);o&&(o.remove(),this.rows.delete(this.end),this.end--),t<this.start&&(this.start=t),this.rows.set(t,s)}})})}async loadBottomRows(t,e){await new Promise(e=>{let i;s.cursor(this.response.connectionId,t,this.start-1,{end:()=>e(),row:(t,e)=>{let s=this.newRow(t,e);i?i.after(s):this.header.after(s),i=s,t<this.start&&(this.start=t),this.rows.set(t,s)}})})}headerCellMousemove(t){if(this.moving)return;const e=t.currentTarget,s=e.getBoundingClientRect();t.offsetX<2?(document.body.css("cursor","col-resize"),this.toMove=e.previousElementSibling):t.offsetX>s.width-4?(document.body.css("cursor","col-resize"),this.toMove=e):(document.body.css("cursor","default"),this.toMove=null)}cellMouseEnter(t){t.addClass("highlight"),t.parentElement.firstElementChild.addClass("highlight"),this.header.find(`div.td${t.dataAttr("col")}`).addClass("highlight")}cellMouseLeave(t){t.removeClass("highlight"),t.parentElement.firstElementChild.removeClass("highlight"),this.header.find(`div.td${t.dataAttr("col")}`).removeClass("highlight")}mousedown(t){this.table&&this.toMove&&(this.moving=!0,document.body.css("cursor","col-resize"),this.toMove.css("border-right-style","dotted"),this.toMove.nextElementSibling&&this.toMove.nextElementSibling.css("border-left-style","dotted"),this.table.findAll(`div.tr > div.td${this.toMove.dataAttr("col")}`).css("border-right-style","dotted"),this.table.findAll(`div.tr > div.td${this.toMove.dataAttr("col")+1}`).css("border-left-style","dotted"))}mouseup(t){if(!this.table)return;if(this.moving=!1,document.body.css("cursor","default"),!this.toMove)return;this.toMove.css("border-right-style",""),this.toMove.nextElementSibling&&this.toMove.nextElementSibling.css("border-left-style","");const e=this.toMove.dataAttr("col");this.table.findAll(`div.tr > div.td${e}`).css("border-right-style",""),this.table.findAll(`div.tr > div.td${e+1}`).css("border-left-style",""),this.toMove=null}mousemove(t){if(!this.table)return;if(!this.moving){const e=t.target;return void(e.parentElement&&(e.parentElement.hasClass("th")||e.parentElement.parentElement.hasClass("th"))||(document.body.css("cursor","default"),this.toMove=null,this.moving=!1))}const e=this.toMove.getBoundingClientRect(),s=t.clientX-e.x-11,i=s+"px";this.toMove.css("min-width",i).css("max-width",i);const o=this.toMove.dataAttr("col");this.table.findAll(`div.tr > div.td${o}`).css("min-width",i).css("max-width",i),this.rowWidths.length&&(this.rowWidths[o-1]=s)}}}],'app/ui/results-pane/messages': [["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.element=e}clear(){this.element.html("")}message(e){document.createElement("code").html(JSON.stringify(e)).appendElementTo(this.element)}finished(e){document.createElement("code").html(JSON.stringify(e)).appendElementTo(this.element)}}}],'app/ui/results-pane/results-pane': [["require","exports","app/api","app/ui/results-pane/grid","app/ui/results-pane/messages"],function(s,e,t,i,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(s,e,l,o){this.undock=o,this.element=e.html(String.html`<div><div class=tab id=results title=results><i class=icon-database></i> <span class=title>Results <span class=badge style="visibility: hidden;"></span></span><div class=stripe style="background-color: ${t.getConnectionColor(l.connection)}"></div></div><div class=tab id=messages title=messages><i class=icon-database></i> <span class=title>Messages <span class=badge style="visibility: hidden;"></span></span><div class=stripe style="background-color: ${t.getConnectionColor(l.connection)}"></div></div><div class=side-info><code></code></div></div><div><div id=results class=pane></div><div id=messages class=pane></div></div><div><div><div></div></div><div><div></div></div><div><div>-</div></div></div>`),this.tabs=this.element.children[0].children.on("click",s=>this.activateByTab(s.currentTarget)),this.panes=this.element.children[1].children,this.footerMsg=this.element.children[2].children[0].children[0],this.footerTime=this.element.children[2].children[1].children[0],this.footerRows=this.element.children[2].children[2].children[0],this.resultsBadge=this.tabs[0].children[1].children[0],this.messagesBadge=this.tabs[1].children[1].children[0],this.grid=new i.default(s,this.panes[0],this),this.messages=new a.default(this.panes[1]),this.activateByTab(this.tabs[0])}setReady(){this.setFooterMsg("🔗 Connected."),this.footerTime.html("🕛 --:--:--").css("title",""),this.footerRows.html("-").css("title",""),this.clearBadges()}setDisconnected(){this.setFooterMsg("⛔ Disconnected."),this.footerTime.html("🕛 --:--:--").attr("title",""),this.footerRows.html("-").attr("title",""),this.clearBadges(),this.tabs[2].children[0].html("")}start(s,e){this.undock(),this.setFooterMsg("Running..."),this.footerTime.html("🕛 --:--:--").attr("title",""),this.footerRows.html(" - "),this.grid.init(),this.messages.clear(),this.clearBadges(),this.query=s,this.tabs[2].children[0].html(s),this.selection=e}notice(s){console.log("notice",s),this.messages.message(s)}error(s){console.log("error",s),this.setFooterMsg(`⚠️ ${s.messageText}`),this.messages.message(s)}end(s){console.log("end",s),this.messages.finished(s),"error"!=s.message&&this.setFooterMsg("✔️ Query executed successfully."),this.footerTime.html(`🕛 ${s.executionTime}`).attr("title",`total time: ${s.executionTime}`),this.footerRows.html(`${s.rowsAffected} rows`),s.rowsAffected<1?this.activateByTab(this.tabs[1]):this.activateByTab(this.tabs[0]),this.grid.done(s),this.resultsBadge.html(s.rowsAffected.toString()).visible(!0)}adjustGrid(){this.grid.adjust()}get footer(){return this.footerMsg.html()}set footer(s){this.footerMsg.html(s)}setFooterMsg(s){this.footerMsg.html(s)}clearBadges(){this.resultsBadge.html("").visible(!1),this.messagesBadge.html("").visible(!1)}activateByTab(s){if(s.hasClass("tab")){for(let e of this.tabs)e.toggleClass("active",s.id==e.id);for(let e of this.panes)e.showElement(s.id==e.id)}}}}],'app/ui/side-panel/panel': [["require","exports","app/_sys/pubsub","app/api","app/controls/monaco-context-menu","app/_sys/timeout"],function(e,t,s,i,l,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class h extends l.default{adjust(){this.element.css("top","0").css("left","0").visible(!1).showElement();const e=this.target.getBoundingClientRect(),t=this.element.getBoundingClientRect();let s;s=e.left+t.width>=window.innerWidth?window.innerWidth-t.width:e.left,this.element.css("top",e.top+e.height+"px").css("left",s+"px").css("min-width",e.width+"px").visible(!0)}}const a={content:null,sticky:!0};t.default=class{constructor(e,t,i=[]){this.element=e,this.key=t,this.header=e.children[0].html(String.html`<div>${t.toUpperCase()}</div><div><span class=btn><i class=icon-menu></i></span></div>`),this.items=e.children[1],this.initiateToggleShadow(),this.initPanelMenu(i),this.items.on("click",e=>this.itemsClick(e)),this.items.on("dblclick",e=>this.itemsDblClick(e)),s.subscribe(s.SCHEMA_CHANGED,(e,t)=>this.schemaChanged(e,t)),s.subscribe(s.TAB_SELECTED,e=>this.selectItemByElement(this.items.find(`#${e}`),!1,a)),s.subscribe(s.TAB_UNSELECTED,e=>this.unselectItemByElement(this.items.find(`#${e}`),!1))}show(e){this.element.showElement(e)}setMainPanelRef(e){return this.mainPanel=e,this}setSidePanelRef(e){return this.sidePanel=e,this}unselectAll(){const e=this.items.findAll(".active");if(e.length>0)for(let t of e)this.unselectItemByElement(t)}createItemElement(e){return String.html`<div class=panel-item>${e}</div>`.toElement()}itemSelected(e,t){}itemUnselected(e){}publishLength(){s.publish(s.ITEM_COUNT_CHANGED,this.key,this.items.children.length)}selectItemByElement(e,t=!0,s){if(0!==e.length&&(e.addClass(i.classes.active),t&&this.itemSelected(e,s),this.items.overflownY())){const t=e.getClientRects(),s=this.items.getClientRects();t[0].top<s[0].top&&e.scrollIntoView({behavior:"instant",block:"start",inline:"start"}),t[0].top+t[0].height>s[0].top+s[0].height&&e.scrollIntoView({behavior:"instant",block:"end",inline:"end"})}}itemsClick(e){const t=e.target.closest("div.panel-item");t&&(t.hasClass(i.classes.active)||(this.sidePanel.unselectAll(),this.selectItemByElement(t,!0,a)))}itemsDblClick(e){const t=e.target.closest("div.panel-item");this.mainPanel.unstickById(t.id)}unselectItemByElement(e,t=!0){e.removeClass(i.classes.active),t&&this.itemUnselected(e)}initPanelMenu(e=[]){e.length?new h({id:`${this.key}-panel-menu`,target:this.header.find(".btn"),event:"click",items:e,onOpen:e=>e.target.addClass(i.classes.active),onClose:e=>e.target.removeClass(i.classes.active)}):this.header.find(".btn").remove()}initiateToggleShadow(){this.items.on("mouseleave",e=>{e.target.css("overflow-y","hidden").css("z-index","")}).on("mouseenter",e=>{let t=e.target;t.scrollHeight>t.clientHeight&&t.css("overflow-y","scroll").css("z-index","1")}).on("scroll",()=>this.toggleHeaderShadow()),this.toggleHeaderShadow()}toggleHeaderShadow(){n.timeout(()=>{this.items.scrollHeight>this.items.clientHeight&&this.items.scrollTop?this.header.addClass("shadow"):this.header.removeClass("shadow")},10,"panel-scroll")}}}],'app/ui/side-panel/routines': [["require","exports","app/api","app/ui/side-panel/panel","app/ui/item-tooltip"],function(e,t,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class extends n.default{constructor(e){super(e,i.Keys.ROUTINES,[{text:"Filter"},{text:"Order ascending"},{text:"Order descending"}])}schemaChanged(e,t){this.items.html("");for(let i of e.routines)this.addNewItem({schema:t,connection:e.connection,...i});this.publishLength()}addNewItem(e){const t=e.comment?String.html`<div class=item-comment>${e.comment.replace("\n","")}</div>`:"";this.createItemElement(String.html`<div><i class=icon-database></i> <span>${e.name}</span></div><div><div class=item-subtext>${e.language} ${e.type} returns ${e.returns}</div>${t}</div>`).dataAttr("item",e).attr("title",a.routineTitle(e)).attr("id",i.RoutineId(e)).appendElementTo(this.items)}itemSelected(e,t){const n=e.dataAttr("item");this.mainPanel.activate(i.RoutineId(n),i.Keys.ROUTINES,n,t)}}}],'app/ui/side-panel/scripts': [["require","exports","app/api","app/ui/side-panel/panel","app/ui/item-tooltip","app/_sys/pubsub"],function(t,e,i,s,a,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class extends s.default{constructor(t){super(t,i.Keys.SCRIPTS,[{text:"New script",keyBindingsInfo:"Ctrl+N",action:()=>this.createScript()},{splitter:!0},{text:"Filter"},{text:"Order ascending"},{text:"Order descending"}]),n.subscribe(n.SCRIPT_UPDATED,t=>this.items.find(`#${i.ScriptId(t)}`).find(".item-subtext").html(t.timestamp.formatDateString()))}schemaChanged(t,e){this.items.html("");for(let i of t.scripts)this.addNewItem({schema:e,connection:t.connection,...i});this.publishLength()}async createScript(){const t=await i.createScript();t.ok&&(this.sidePanel.unselectAll(),this.selectItemByElement(this.addNewItem(t.data),!0,{content:t.data,sticky:!1}),this.publishLength())}addNewItem(t){const e=t.comment?String.html`<div class=item-comment>${t.comment.replace("\n","")}</div>`:"";return this.createItemElement(String.html`<div><i class=icon-doc-text></i> <span>${t.name}</span></div><div><div class=item-subtext>${t.timestamp.formatDateString()}</div>${e}</div>`).dataAttr("item",t).attr("title",a.scriptTitle(t)).attr("id",i.ScriptId(t)).appendElementTo(this.items)}itemSelected(t,e){const s=t.dataAttr("item");this.mainPanel.activate(i.ScriptId(s),i.Keys.SCRIPTS,s,e)}}}],'app/ui/side-panel/search': [["require","exports","app/api","app/ui/side-panel/panel"],function(e,s,a,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});s.default=class extends t.default{constructor(e){super(e,a.Keys.SEARCH)}schemaChanged(e,s){}}}],'app/ui/side-panel/tables': [["require","exports","app/api","app/ui/side-panel/panel","app/ui/item-tooltip"],function(e,t,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends s.default{constructor(e,t){super(e,t,[{text:"Filter"},{text:"Order ascending"},{text:"Order descending"}])}schemaChanged(e,t){this.items.html("");for(let i of e[this.key])this.addNewItem({schema:t,connection:e.connection,...i});this.publishLength()}addNewItem(e){const t=e.comment?String.html`<div class=item-comment>${e.comment.replace("\n","")}</div>`:"";this.createItemElement(String.html`<div><i class=icon-database></i> <span>${e.name}</span></div><div><div class=item-subtext>count ≈ ${e.estimate}</div>${t}</div>`).dataAttr("item",e).attr("title",a.tableTitle(e)).attr("id",i.TableId(e)).appendElementTo(this.items)}itemSelected(e,t){const s=e.dataAttr("item");this.mainPanel.activate(i.TableId(s),this.key,s,t)}}t.Tables=class extends n{constructor(e){super(e,i.Keys.TABLES)}};t.Views=class extends n{constructor(e){super(e,i.Keys.VIEWS)}}}],'app/ui/side-panel/_side-panels': [["require","exports","app/_sys/pubsub","app/ui/side-panel/scripts","app/ui/side-panel/tables","app/ui/side-panel/routines","app/ui/side-panel/search","app/api"],function(e,i,s,n,t,l,d,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.default=class{constructor(e,i){this.panels=new Map,e.addClass("side-panel").html(String.html`<div style="display: none;"><div></div><div></div></div><div style="display: none;"><div></div><div></div></div><div style="display: none;"><div></div><div></div></div><div style="display: none;"><div></div><div></div></div><div style="display: none;"><div></div><div></div></div>`),this.panels.set(a.Keys.SCRIPTS,new n.default(e.children[0]).setMainPanelRef(i).setSidePanelRef(this)),this.panels.set(a.Keys.TABLES,new t.Tables(e.children[1]).setMainPanelRef(i).setSidePanelRef(this)),this.panels.set(a.Keys.VIEWS,new t.Views(e.children[2]).setMainPanelRef(i).setSidePanelRef(this)),this.panels.set(a.Keys.ROUTINES,new l.default(e.children[3]).setMainPanelRef(i).setSidePanelRef(this)),this.panels.set(a.Keys.SEARCH,new d.default(e.children[4]).setMainPanelRef(i).setSidePanelRef(this)),s.subscribe([s.STATE_CHANGED_SCRIPTS,s.STATE_CHANGED_TABLES,s.STATE_CHANGED_VIEWS,s.STATE_CHANGED_ROUTINES,s.STATE_CHANGED_SEARCH],(e,i)=>{this.panels.get(e).show(i)}),s.subscribe(s.TAB_SELECTED,(e,i,s,n)=>{if(i&&s===a.getCurrentSchema()&&n===a.getCurrentConnection())for(let[e,s]of this.panels)i==e?s.show(!0):s.show(!1)})}unselectAll(){for(let e of this.panels.values())e.unselectAll()}}}],'app/ui/toolbar/toolbar': [["require","exports","app/_sys/storage","app/_sys/pubsub","app/controls/monaco-context-menu","app/api"],function(e,t,s,i,a,o){"use strict";var l;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.switch="switch",e.toggle="toggle"}(l||(l={}));const c=e=>((e,t)=>e.dataAttr("role")===t)(e,l.switch),n=e=>e===o.Position.LEFT?"Move Toolbar to Right":"Move Toolbar to Left",d=new s.default({scripts:!1,tables:!1,views:!1,routines:!1,search:!1,previousKey:o.Keys.SCRIPTS,pgcode:!1},"state",(e,t)=>"previousKey"!==e?JSON.parse(t):t),r=[{id:`btn-${o.Keys.SCRIPTS}`,icon:"icon-doc-text",key:o.Keys.SCRIPTS,label:o.Keys.SCRIPTS,text:"Scripts",keyBinding:"Ctrl+S",role:l.switch},{id:`btn-${o.Keys.TABLES}`,icon:"icon-database",key:o.Keys.TABLES,label:o.Keys.TABLES,text:"Tables",keyBinding:"Ctrl+T",role:l.switch},{id:`btn-${o.Keys.VIEWS}`,icon:"icon-database",key:o.Keys.VIEWS,label:o.Keys.VIEWS,text:"Views",keyBinding:"Ctrl+V",role:l.switch},{id:`btn-${o.Keys.ROUTINES}`,icon:"icon-database",key:o.Keys.ROUTINES,label:o.Keys.ROUTINES,text:"Routines",keyBinding:"Ctrl+R",role:l.switch},{id:`btn-${o.Keys.SEARCH}`,icon:"icon-search",key:o.Keys.SEARCH,label:o.Keys.SEARCH,text:"Search",keyBinding:"Ctrl+F",role:l.switch}];t.default=class{constructor(e,t,s){let l="",c=new Array;for(let t of r)l+=`\n            <div class="${t.icon} ${t.id}" id="${t.id}" data-key="${t.key}" data-role="${t.role}" title="${t.label} (${t.keyBinding})">\n                <div class="marker"></div>\n                <div class="lbl">${t.label}</div>\n                <div class="count" style="display: none"></div>\n            </div>`,t.text&&c.push({id:t.key,text:t.text,keyBindingsInfo:t.keyBinding,action:()=>e.find("#"+t.id).trigger("click")});this.toolbar=e.addClass("toolbar").html(l),t===o.Position.RIGHT&&this.toolbar.addClass("right"),c.push({splitter:!0},{id:"move",text:n(t),action:()=>{let e=t==o.Position.LEFT?o.Position.RIGHT:o.Position.LEFT;s.moveToolbar(e)&&((t=e)===o.Position.RIGHT?this.toolbar.addClass("right"):this.toolbar.removeClass("right"),this.menu.updateMenuItem("move",{text:n(t)}))}}),this.menu=new a.default({id:"ctx-menu-toolbar",items:c,target:e}),this.buttons=this.toolbar.children.on("click",e=>this.buttonClicked(e.currentTarget));for(let e of this.buttons){const t=e.dataAttr("key");this.setButtonState(e,d[t],t)}i.subscribe(i.SIDEBAR_DOCKED,()=>this.sidebarDocked()),i.subscribe(i.SIDEBAR_UNDOCKED,()=>this.sidebarUndocked()),i.subscribe(i.ITEM_COUNT_CHANGED,(e,t)=>{let s=this.buttons.namedItem("btn-"+e),i=s.find(".count").html(t).showElement();t.toString().length>2?i.css("width","16px"):i.css("width","10px");let a=s.attr("title").split("\n");s.attr("title",a[0]+"\n"+t+" items")}),i.subscribe(i.TAB_SELECTED,(e,t,s,i)=>{if(t&&s===o.getCurrentSchema()&&i===o.getCurrentConnection())for(let e of this.buttons){const s=e.hasClass(o.classes.active);t===e.dataAttr("key")?s||e.addClass(o.classes.active):s&&e.removeClass(o.classes.active)}}),i.subscribe(i.CONNECTION_SET,e=>{this.toolbar.findAll(".marker").css("background-color",o.getConnectionColor(e))})}sidebarDocked(){this.toolbar.addClass(o.classes.docked);for(let e of this.buttons)e.hasClass(o.classes.active)&&c(e)&&this.menu.updateMenuItem(e.dataAttr("key"),{checked:!1})}sidebarUndocked(){let e=!1;for(let t of r){if(t.role!==l.switch)continue;let s=this.buttons.namedItem(t.id);if(s.hasClass(o.classes.active)){e=!0,this.menu.updateMenuItem(s.dataAttr("key"),{checked:!0});break}}if(!e&&d.previousKey){let e=d.previousKey;for(let t of this.buttons)if(t.dataAttr("key")===e){t.addClass(o.classes.active),d[e]=!0,i.publish(i.STATE_CHANGED+e,e,!0),this.menu.updateMenuItem(e,{checked:!0});break}}this.toolbar.removeClass(o.classes.docked)}setButtonState(e,t,s){e.hasClass(o.classes.active)&&!t?(e.removeClass(o.classes.active),setTimeout(()=>i.publish(i.STATE_CHANGED+s,s,!1))):!e.hasClass(o.classes.active)&&t&&(e.addClass(o.classes.active),setTimeout(()=>i.publish(i.STATE_CHANGED+s,s,!0))),c(e)&&this.menu.updateMenuItem(s,{checked:t})}buttonClicked(e){const t=e.dataAttr("key");let s=c(e);const a=a=>{void 0===a&&(a=e.hasClass(o.classes.active)),a?(e.removeClass(o.classes.active),s&&(d.previousKey=t)):e.addClass(o.classes.active),a=!a,d[t]=a,i.publish(i.STATE_CHANGED+t,t,a),s&&this.menu.updateMenuItem(t,{checked:a})};if(s){const t=this.toolbar.hasClass(o.classes.docked);for(let t of this.buttons)if(c(t)&&e.id!==t.id){const e=t.dataAttr("key");d[e]&&(d[e]=!1),t.hasClass(o.classes.active)&&(t.removeClass("active"),i.publish(i.STATE_CHANGED+e,e,!1),this.menu.updateMenuItem(e,{checked:!1}))}t?a(!1):a(),e.hasClass(o.classes.active)?i.publish(i.STATE_CHANGED_ON):i.publish(i.STATE_CHANGED_OFF)}else a()}}}],'app/_sys/grpc-service': [["require","exports","libs/grpc-web/index.js","libs/google-protobuf/google-protobuf.js"],function(e,t,i,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Any=0]="Any",e[e.Int32=1]="Int32",e[e.Int32String=2]="Int32String",e[e.Int64=3]="Int64",e[e.Int64String=4]="Int64String",e[e.Uint32=5]="Uint32",e[e.Uint32String=6]="Uint32String",e[e.Uint64=7]="Uint64",e[e.Uint64String=8]="Uint64String",e[e.Sint32=9]="Sint32",e[e.Sint64=10]="Sint64",e[e.SintHash64=11]="SintHash64",e[e.Sint64String=12]="Sint64String",e[e.Fixed32=13]="Fixed32",e[e.Fixed64=14]="Fixed64",e[e.Fixed64String=15]="Fixed64String",e[e.Sfixed32=16]="Sfixed32",e[e.Sfixed64=17]="Sfixed64",e[e.Sfixed64String=18]="Sfixed64String",e[e.Float=19]="Float",e[e.Double=20]="Double",e[e.Bool=21]="Bool",e[e.Enum=22]="Enum",e[e.String=23]="String",e[e.MessageSet=24]="MessageSet",e[e.Group=25]="Group",e[e.Bytes=26]="Bytes",e[e.FixedHash64=27]="FixedHash64",e[e.VarintHash64=28]="VarintHash64",e[e.SplitFixed64=29]="SplitFixed64",e[e.SplitVarint64=30]="SplitVarint64",e[e.SplitZigzagVarint64=31]="SplitZigzagVarint64",e[e.RepeatedInt32=32]="RepeatedInt32",e[e.RepeatedInt32String=33]="RepeatedInt32String",e[e.RepeatedInt64=34]="RepeatedInt64",e[e.RepeatedSplitVarint64=35]="RepeatedSplitVarint64",e[e.RepeatedSplitZigzagVarint64=36]="RepeatedSplitZigzagVarint64",e[e.RepeatedInt64String=37]="RepeatedInt64String",e[e.RepeatedUint32=38]="RepeatedUint32",e[e.RepeatedUint32String=39]="RepeatedUint32String",e[e.RepeatedUint64=40]="RepeatedUint64",e[e.RepeatedUint64String=41]="RepeatedUint64String",e[e.RepeatedSint32=42]="RepeatedSint32",e[e.RepeatedSint64=43]="RepeatedSint64",e[e.RepeatedSint64String=44]="RepeatedSint64String",e[e.RepeatedSintHash64=45]="RepeatedSintHash64",e[e.RepeatedFixed32=46]="RepeatedFixed32",e[e.RepeatedFixed64=47]="RepeatedFixed64",e[e.RepeatedFixed64String=48]="RepeatedFixed64String",e[e.RepeatedSfixed32=49]="RepeatedSfixed32",e[e.RepeatedSfixed64=50]="RepeatedSfixed64",e[e.RepeatedSfixed64String=51]="RepeatedSfixed64String",e[e.RepeatedFloat=52]="RepeatedFloat",e[e.RepeatedDouble=53]="RepeatedDouble",e[e.RepeatedBool=54]="RepeatedBool",e[e.RepeatedEnum=55]="RepeatedEnum",e[e.RepeatedString=56]="RepeatedString",e[e.RepeatedBytes=57]="RepeatedBytes",e[e.RepeatedFixedHash64=58]="RepeatedFixedHash64",e[e.RepeatedVarintHash64=59]="RepeatedVarintHash64",e[e.PackedInt32=60]="PackedInt32",e[e.PackedInt32String=61]="PackedInt32String",e[e.PackedInt64=62]="PackedInt64",e[e.PackedSplitFixed64=63]="PackedSplitFixed64",e[e.PackedSplitVarint64=64]="PackedSplitVarint64",e[e.PackedSplitZigzagVarint64=65]="PackedSplitZigzagVarint64",e[e.PackedInt64String=66]="PackedInt64String",e[e.PackedUint32=67]="PackedUint32",e[e.PackedUint32String=68]="PackedUint32String",e[e.PackedUint64=69]="PackedUint64",e[e.PackedUint64String=70]="PackedUint64String",e[e.PackedSint32=71]="PackedSint32",e[e.PackedSint64=72]="PackedSint64",e[e.PackedSint64String=73]="PackedSint64String",e[e.PackedSintHash64=74]="PackedSintHash64",e[e.PackedFixed32=75]="PackedFixed32",e[e.PackedFixed64=76]="PackedFixed64",e[e.PackedFixed64String=77]="PackedFixed64String",e[e.PackedSfixed32=78]="PackedSfixed32",e[e.PackedSfixed64=79]="PackedSfixed64",e[e.PackedSfixed64String=80]="PackedSfixed64String",e[e.PackedFloat=81]="PackedFloat",e[e.PackedDouble=82]="PackedDouble",e[e.PackedBool=83]="PackedBool",e[e.PackedEnum=84]="PackedEnum",e[e.PackedFixedHash64=85]="PackedFixedHash64",e[e.PackedVarintHash64=86]="PackedVarintHash64"}(n=t.GrpcType||(t.GrpcType={})),function(e){e[e.OK=0]="OK",e[e.Cancelled=1]="Cancelled",e[e.Unknown=2]="Unknown",e[e.InvalidArgument=3]="InvalidArgument",e[e.DeadlineExceeded=4]="DeadlineExceeded",e[e.NotFound=5]="NotFound",e[e.AlreadyExists=6]="AlreadyExists",e[e.PermissionDenied=7]="PermissionDenied",e[e.ResourceExhausted=8]="ResourceExhausted",e[e.FailedPrecondition=9]="FailedPrecondition",e[e.Aborted=10]="Aborted",e[e.OutOfRange=11]="OutOfRange",e[e.Unimplemented=12]="Unimplemented",e[e.Internal=13]="Internal",e[e.Unavailable=14]="Unavailable",e[e.DataLoss=15]="DataLoss",e[e.Unauthenticated=1]="Unauthenticated"}(t.GrpcErrorCode||(t.GrpcErrorCode={}));const r=(e,t,i)=>!e||t>=e.length?i:e[t];t.GrpcService=class{constructor(e={}){e=Object.assign({host:"",format:"text"},e),this.client=new i.GrpcWebClientBase({format:e.format,suppressCorsPreflight:e.suppressCorsPreflight}),this.host=e.host}unaryCall(e,...t){return e=this.parseRpcCallArgs(e),new Promise((i,a)=>{this.client.rpcCall(`${this.host}${e.service}`,{array:t},e.metadata,this.createMethodDescriptor(e,!1),(e,t)=>e?a(e):i(t))})}serverStreaming(e,...t){return e=this.parseRpcCallArgs(e),this.client.serverStreaming(`${this.host}${e.service}`,{array:t},e.metadata,this.createMethodDescriptor(e,!0))}parseRpcCallArgs(e){if(!(e=Object.assign({metadata:{},request:new Array,reply:new Array,resultNames:new Array},e)).service)throw e.service;return e}createMethodDescriptor(e,t){return new i.MethodDescriptor(e.service,t?i.MethodType.SERVER_STREAMING:i.MethodType.UNARY,function(e){a.Message.initialize(this,e,0,-1,null,null)},function(e){a.Message.initialize(this,e,0,-1,null,null)},t=>this.serializeBinary(t,e.request),t=>this.deserializeBinary(t,e))}serializeBinary(e,t){const i=new a.BinaryWriter;return this.serializeBinaryToWriter(e,i,t),i.getResultBuffer()}serializeBinaryToWriter(e,t,i){for(let a=0,d=e.array.length;a<d;a++)t["write"+n[r(i,a,n.String)]](a+1,e.array[a])}deserializeBinary(e,t){const i={},d=new a.BinaryReader(e);for(;d.nextField()&&!d.isEndGroup();){let e,a,s=d.getFieldNumber(),l=r(t.reply,s-1,n.String);if(l instanceof Object&&!(l instanceof Array)){let t=Object.entries(l);e=t[0][0],a=t[0][1]}else e=s,a=l;if(a instanceof Array){let t={};if(!a.length)continue;a[0]instanceof Object?d.readMessage(t,(e,t)=>this.deserializeMessage(e,t,a)):t=d["read"+n[a[0]]]();let r=i[e];r?r.push(t):i[e]=[t]}else{let t=n[a];i[e]=d["read"+t]()}}return i}deserializeMessage(e,t,i){for(;t.nextField()&&!t.isEndGroup();){let a,d,s=t.getFieldNumber(),l=r(i,s-1,n.String);if(l instanceof Object){let e=Object.entries(l);a=e[0][0],d=e[0][1]}else a=s,d=l;let c=n[d];e[a]=t["read"+c]()}return e}}}],'app/_sys/pubsub': [["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s={},E={};t.subscribe=((e,t,T)=>{const a=e=>{let a=s[e];a||(a=s[e]=[]);const n=(e+t).hashCode();if(T){if(!E[n])return E[n]=!0,s[e].push(t)-1}else E[n]=!0,s[e].push(t);return n};if(!(e instanceof Array))return a(e);for(let t of e)a(t)}),t.publish=((e,...t)=>{const E=e=>{const E=s[e];if(E)for(let e of E)e(...t)};if(e instanceof Array)for(let t of e)E(t);else E(e)}),t.unsubscribe=((e,t)=>{let E=s[e];return!!E&&(E.splice(t,1),!0)}),t.STATE_CHANGED_ON="state/changed/on/",t.STATE_CHANGED_OFF="state/changed/off/",t.STATE_CHANGED="state/changed/",t.STATE_CHANGED_SCRIPTS="state/changed/scripts",t.STATE_CHANGED_TABLES="state/changed/tables",t.STATE_CHANGED_VIEWS="state/changed/views",t.STATE_CHANGED_ROUTINES="state/changed/routines",t.STATE_CHANGED_SEARCH="state/changed/search",t.SIDEBAR_DOCKED="sidebar/docked/",t.SIDEBAR_UNDOCKED="sidebar/undocked/",t.CLOSE_CONTEXT_MENU="context-menu/close/",t.SET_APP_STATUS="app/status/",t.API_INITIAL="api/initial/",t.SCHEMA_CHANGED="app/schema/",t.ITEM_COUNT_CHANGED="item/count/",t.SPLITTER_CHANGED="splitter/changed",t.TAB_SELECTED="tab/selected",t.TAB_UNSELECTED="tab/unselected",t.SCRIPT_UPDATED="script/updated",t.CONNECTION_SET="connection/set",t.CONTENT_ACTIVATED="content/activated",t.EDITOR_POSITION="editor/position",t.FOOTER_MESSAGE="footer/message",t.DISMISS_FOOTER_MESSAGE="footer/message/dismiss",t.FOOTER_MESSAGE_DISMISSED="footer/message/dismissed"}],'app/_sys/storage': [["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s="pgcode";class r{constructor(){this.dict={},this.storage=localStorage}clear(){throw new Error("Method not implemented.")}key(e){throw new Error("Method not implemented.")}getItem(e){let t=this.dict[e];if(void 0===t){if(null===(t=this.storage.getItem(e)))return null;this.dict[e]=t}return t}setItem(e,t){this.storage.setItem(e,t),this.dict[e]=t}removeItem(e){this.storage.removeItem(e),delete this.dict[e]}}t.default=class{constructor(e,t="",s=((e,t)=>t),i=((e,t)=>t),o=new r){this._storage=new r,this._names=new Array,this._storage=o,this._namespace=t,this._get=s,this._set=i;for(let[t,s]of Object.entries(e))this.create(t,s)}get storageKeys(){return this._names}create(e,t){let s=this.getName(e);return Object.defineProperty(this,e,{get:()=>{const r=this._storage.getItem(s);return null===r&&void 0!==t?t:this._get(e,r)},set:t=>{null===t?this._storage.removeItem(s):this._storage.setItem(s,this._set(e,t))}}),this._names.push(e),this}getName(e){return this._namespace?`${s}.${this._namespace}.${e}`:`${s}.${e}`}}}],'app/_sys/timeout': [["require","exports"],function(t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const e={},i={};s.timeout=((t,s,i)=>{let o=e[i];o&&(clearTimeout(o),e[i]=void 0),e[i]=setTimeout(()=>{t(),clearTimeout(e[i]),e[i]=void 0},s)}),s.timeoutAsync=(async(t,s,o)=>{let u=e[o];u&&(clearTimeout(u),e[o]=void 0,i[o]&&await i[o]),e[o]=setTimeout(async()=>{const s=t();i[o]=s,await s,clearTimeout(e[o]),e[o]=void 0,i[o]=void 0},s)});s.Consumer=class{constructor(t,s){this.shouldRun=!1,this.timeout=0,t&&(this.handler=t),s&&(this.timeout=s),this.start()}run(t){t&&(this.handler=t),this.shouldRun=!0}stop(){this.shouldRun=!1}start(){setTimeout(async()=>{this.shouldRun&&(this.shouldRun=!1,await this.handler()),this.start()},this.timeout)}}}],}});!function(){try{Function("() => {};"),window.customElements.get("test")}catch(r){throw"update your browser!"}const r={urlArgs:"0.0.0.5",baseUrl:"",paths:{vs:"libs/monaco-editor/min/vs"}},e=()=>void 0!=window.require,o=()=>{};e()?(require.config(r),require(["js/_main"],o)):((e,o)=>{let n=document.createElement("script");n.async=!0,n.src=e+(r.urlArgs?"?"+r.urlArgs:""),n.onload=o,n.onerror=o,document.body.appendChild(n)})("js/loader/loader.js",()=>{if(e())return require.config(r),void require(["js/_main"],o);console.warn("Failed to load module loader.")})}();